<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="OMBOrderMngDAO">

	<!--
         쿼리명 : OMBOrderMngDAO.selectOrderMngList
         설  명 : 외주업체 발주관리 목록을 조회한다.
       	  수정일     수정자      수정내용 
        ==========   ======   ============== 
        2016.03.18   김필기     최초 생성
		2018.07.20   한상민     mmoder 계정 전체 수정
    -->
    <select id="OMBOrderMngDAO.selectOrderMngList" parameterType="emfMap" resultType="emfMap">
		SELECT /* OMBOrderMngDAO.selectOrderMngList */
			   TBL.* 
			   , FN_PROD_NM(TBL.PROD_CD) AS PROD_NM
			   , (SELECT PROD_KIND_NM FROM PRODUCT_KIND WHERE SEQ = TBL.PROD_KIND AND MODEL_CL_CD = TBL.PROD_MODEL_KIND) AS PROD_KIND_NM
			   , DECODE(FN_ACCNT_STAT(TBL.ACCNT_NO), 'Y', '정상', 'R', '해약', 'E', '행사', '청약철회') AS ACC_STAT
		FROM (
			SELECT ROWNUM AS RNUM, T1.*
			FROM (
			    <if test="idList != null">
				<foreach collection="idList" item="id" open="(" separator=") UNION ALL (" close=")">


				SELECT #{id} AS ADM_ID, A.MEM_NM, A.CELL, A.HOME_ADDR, A.HOME_ADDR2, A.NOTE AS NOTE2, B.ACCNT_NO
, B.JOIN_DT, B.PROD_CD, B.PROD_KIND, B.PROD_MODEL_KIND, B.INSPL_ZIP, B.INSPL_ADDR, B.INSPL_ADDR2, B.INSPL_PHONE, B.ORDER_NUM, B.B2B_EMPLE_NO
, F.ORDER_DT, F.CONFIRM_DT, F.DELIVERY_DT, F.HOLD_DT, F.UPDATE_CELL, F.UPDATE_ADDR, E.COM_NM AS B2B_COMP_NM, F.UPDATE_TYPE, F.NOTE, F.HPCALL_YN, F.ETC
				<choose>
					<when test="orderdateMng == 'Y'.toString()">
						, B.KB_NO
						, FN_MODEL_CL_NM(B.PROD_MODEL_KIND) AS PROD_MODEL
						, (SELECT X2.MODEL_NM 
						     FROM PRODUCT_MODEL_MST X1, PRODUCT_MODEL_DTL X2
							WHERE X1.SEQ = X2.SEQ 
							  AND X1.DEL_FG = 'N'
							  AND X1.PROD_CD = B.PROD_CD 
							  AND X1.PROD_KIND = B.PROD_MODEL_KIND 
							  AND X2.MODEL_CD = B.PROD_MODEL_CD) AS PROD_MODEL_NM
						, F.UPDATE_PADDR
						, F.NOSETUP_ETC
					</when>
					<otherwise>
						, B.KB_NO
						, FN_MODEL_CL_NM(B.PROD_MODEL_KIND) AS PROD_MODEL
						, (SELECT X2.MODEL_NM 
						     FROM PRODUCT_MODEL_MST X1, PRODUCT_MODEL_DTL X2
							WHERE X1.SEQ = X2.SEQ 
							  AND X1.DEL_FG = 'N'
							  AND X1.PROD_CD = B.PROD_CD 
							  AND X1.PROD_KIND = B.PROD_MODEL_KIND 
							  AND X2.MODEL_CD = B.PROD_MODEL_CD) AS PROD_MODEL_NM
						, F.UPDATE_PADDR
						, F.NOSETUP_ETC
					</otherwise>	
				</choose>
						
				  FROM MEMBER A, MEM_PROD_ACCNT B, PRODUCT C, B2BCOMCD E, DELIVERY_INFO F
				 WHERE A.MEM_NO = B.MEM_NO
				   AND B.PROD_CD = C.PROD_CD
				   AND B.B2B_COMP_CD = E.COM_CD(+)
				   
				<choose>
					<when test="orderdateMng == 'Y'.toString()">
						AND B.ACCNT_NO = F.ACCNT_NO(+) 
					</when>
					<otherwise>
						AND B.ACCNT_NO = F.ACCNT_NO
					</otherwise>	
				</choose>
				
				   AND A.DEL_FG = 'N'
				   AND B.DEL_FG = 'N'
				   AND EXISTS(SELECT 'X' FROM PAY_MNG WHERE DEL_FG = 'N' AND ACCNT_NO = B.ACCNT_NO)
				 
				<if test="id == 'lgorder'">
					AND (	(C.SECTION_THR IN ('0001','0006','0014') AND C.SECTION_T = '0002') 
						OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
						OR (C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG')) 
						OR (C.SECTION_THR = '0021' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG')) 
						OR (C.SECTION_THR = '0026' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG')) 
						OR (C.SECTION_THR = '0025' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG')) 
						OR (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG')) 
						OR (C.SECTION_THR = '0008' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
						OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG')) 
						OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG')))
				</if>		
				<if test="id == 'csvorder'">
					AND ((C.SECTION_THR IN ('0002','0015') AND C.SECTION_F != '0002') 
					OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
					OR (C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS')) 
					OR (C.SECTION_THR = '0021' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS')) 
					OR (C.SECTION_THR = '0026' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS')) 
					OR (C.SECTION_THR = '0025' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
					OR (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
					OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS')) 
					OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))) 
				</if>
				<if test="id == 'dhorder'">
					AND ((C.SECTION_THR = '0012' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH')) 
					OR (C.SECTION_THR = '0017' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH')) 
					OR (C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
					OR (C.SECTION_THR = '0021' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
					OR (C.SECTION_THR = '0026' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH')) 
					OR (C.SECTION_THR = '0025' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
					OR (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
					OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH')) 
					OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
					OR (C.SECTION_THR = '0031' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH')) 
         			OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))) 
				</if>
				<if test="id == 'isollat' or id == 'isorder'">
					AND (
					(C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER IN ( 'isollat', 'isorder' ) ))
					OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER IN ( 'isollat', 'isorder') ))
					) 
				</if>
				<if test="id == 'sonoseason'">
					AND (
					(C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'sono'))
					OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'sono'))
					OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'sono'))
					) 
				</if>
				<if test="id == 'wmnetwork'">
					AND (
					(C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'wmnet'))
					OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'wmnet'))
					OR (C.SECTION_THR = '0021' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'wmnet'))
					OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'wmnet'))
					) 
				</if>
				
				<if test="id == 'mmorder'">
					AND (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LU'))
				</if>	
				<choose>
					<when test="orderdateMng == 'Y'.toString()">
						<if test="id == 'dyorder'">
							AND (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DY'))
						</if>					
					</when>
					<otherwise>
						<if test="id == 'dyorder'">
		                    AND (F.B2B_STAT = 'DONGYANG' 
		                         AND C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DY'))
						</if>					
					</otherwise>	
				</choose>
				
<!-- 
				<choose>
					<when test="orderdateMng == 'Y'.toString()">
						<if test="id == 'dyorder'">
							AND (C.PROD_GUBUN = '0028' 
							OR (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LV'))
		         			OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LV')))
						</if>					
					</when>
					<otherwise>
						<if test="id == 'dyorder'">
							AND F.B2B_STAT = 'DONGYANG'
						</if>					
					</otherwise>	
				</choose>
 -->
				<if test="daysel != null and daysel !=''">		
					<if test="strtDt != null and strtDt != '' and endDt != null and endDt != ''">
						<if test="daysel == 'orderDt'">						
							AND F.ORDER_DT <![CDATA[>=]]> REPLACE(#{strtDt}, '-', '')
							AND F.ORDER_DT <![CDATA[<=]]> REPLACE(#{endDt}, '-', '')
						</if>
						<if test="daysel == 'joinDt'">
							AND B.JOIN_DT <![CDATA[>=]]> REPLACE(#{strtDt}, '-', '')
							AND B.JOIN_DT <![CDATA[<=]]> REPLACE(#{endDt}, '-', '')
						</if>
						<if test="daysel == 'rescc'">
							AND EXISTS(SELECT 'X' FROM RESCISSION WHERE DEL_FG = 'N' AND ACCNT_NO = B.ACCNT_NO AND RESN_PROC_DAY <![CDATA[>=]]> REPLACE(#{strtDt}, '-', '') AND RESN_PROC_DAY <![CDATA[<=]]> REPLACE(#{endDt}, '-', ''))
						</if>
						<if test="daysel == 'orderChk'">
							AND REPLACE(F.UPDATE_ADDR, ' ', '') != REPLACE(B.INSPL_ZIP || ')' || B.INSPL_ADDR || B.INSPL_ADDR2, ' ', '')
							AND F.UPDATE_TYPE != (SELECT PROD_KIND_NM FROM PRODUCT_KIND WHERE SEQ = B.PROD_KIND AND MODEL_CL_CD = B.PROD_MODEL_KIND)
							AND F.UPDATE_CELL != A.CELL 
							AND F.ORDER_DT <![CDATA[>=]]> REPLACE(#{strtDt}, '-', '')
							AND F.ORDER_DT <![CDATA[<=]]> REPLACE(#{endDt}, '-', '')		
						</if>
						<if test="daysel == 'confirmDt'">
							AND F.CONFIRM_DT <![CDATA[>=]]> REPLACE(#{strtDt}, '-', '')
							AND F.CONFIRM_DT <![CDATA[<=]]> REPLACE(#{endDt}, '-', '')
						</if>
						<if test="daysel == 'deliveryDt'">
							AND F.DELIVERY_DT <![CDATA[>=]]> REPLACE(#{strtDt}, '-', '')
							AND F.DELIVERY_DT <![CDATA[<=]]> REPLACE(#{endDt}, '-', '')
						</if>
						<if test="daysel == 'holdDt'">
							AND F.HOLD_DT <![CDATA[>=]]> REPLACE(#{strtDt}, '-', '')
							AND F.HOLD_DT <![CDATA[<=]]> REPLACE(#{endDt}, '-', '')
						</if>
						<if test="daysel == 'allAccnt'">
							AND MEM_NM IN (
								SELECT MEM_NM 
								  FROM MEMBER A, MEM_PROD_ACCNT B, PRODUCT C, DELIVERY_INFO D
								 WHERE A.MEM_NO = B.MEM_NO
								   AND B.PROD_CD = C.PROD_CD
								   AND B.ACCNT_NO = D.ACCNT_NO
								   AND A.DEL_FG = 'N'
								   AND B.DEL_FG = 'N'
								<if test="id == 'lgorder'">
									AND (	(C.SECTION_THR IN ('0001','0006','0014') AND C.SECTION_T = '0002') 
										OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
										OR (C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG')) 
										OR (C.SECTION_THR = '0021' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG')) 
										OR (C.SECTION_THR = '0026' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG')) 
										OR (C.SECTION_THR = '0025' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG')) 
										OR (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG')) 
										OR (C.SECTION_THR = '0008' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
										OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG')) 
										OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))) 
								</if>		
								<if test="id == 'csvorder'">
									AND ((C.SECTION_THR IN ('0002','0015') AND C.SECTION_F != '0002') 
									OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
									OR (C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS')) 
									OR (C.SECTION_THR = '0021' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS')) 
									OR (C.SECTION_THR = '0026' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS')) 
									OR (C.SECTION_THR = '0025' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
									OR (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
									OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS')) 
									OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))) 
								</if>
								<if test="id == 'dhorder'">
									AND ((C.SECTION_THR = '0012' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH')) 
									OR (C.SECTION_THR = '0017' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH')) 
									OR (C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
									OR (C.SECTION_THR = '0021' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
									OR (C.SECTION_THR = '0026' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH')) 
									OR (C.SECTION_THR = '0025' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
									OR (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
									OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH')) 
									OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
									OR (C.SECTION_THR = '0031' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH')) 
				         			OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))) 
								</if>
								<if test="id == 'isollat' or id == 'isorder'">
									AND (
									(C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER IN ( 'isollat', 'isorder' ) ))
									OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER IN ( 'isollat', 'isorder') ))
									)
								</if>
								
								<if test="id == 'sonoseason'">
									AND (
									(C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'sono'))
									OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'sono'))
									OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'sono'))
									) 
								</if>
								
								<if test="id == 'wmnetwork'">
									AND (
									(C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'wmnet'))
									OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'wmnet'))
									OR (C.SECTION_THR = '0021' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'wmnet'))
									OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'wmnet'))
									) 
								</if>
								
								<if test="id == 'mmorder'">
									AND (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LU'))
								</if>		
								<if test="id == 'dyorder'">
									AND C.PROD_GUBUN IN ('0024', '0025', '0027') 
								</if>
								   AND D.ORDER_DT <![CDATA[>=]]> REPLACE(#{strtDt}, '-', '')
								   AND D.ORDER_DT <![CDATA[<=]]> REPLACE(#{endDt}, '-', '')
								 GROUP BY A.MEM_NM, A.CELL 
								HAVING COUNT(A.MEM_NM) <![CDATA[>]]> 1
							)
						</if>
						<if test="daysel == 'noSetup'">
							AND TRUNC(TO_DATE(F.ORDER_DT, 'yyyyMMdd') - SYSDATE) <![CDATA[>=]]> 32 
							AND F.DELIVERY_DT IS NULL 
							AND FN_ACCNT_STAT(TBL.ACCNT_NO) NOT IN('Y', 'R', 'E')
						</if>
					</if>
				</if>
				<if test="q != null and q != ''">	
					<if test="f == 1">	
						AND A.MEM_NM LIKE '%' || #{q} || '%'
					</if>
					<if test="f == 2">	
						AND B.ACCNT_NO = #{q}
					</if>
					<if test="f == 3">	
						AND NVL(F.UPDATE_CELL, A.CELL) = #{q}
					</if>
					<if test="f == 4">	
						AND EXISTS(SELECT 'X' FROM PRODUCT WHERE PROD_CD = B.PROD_CD AND PROD_NM LIKE '%' || #{q} || '%')
					</if>
					<if test="f == 5">	
						AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND MODEL_CL_NM LIKE '%' || #{q} || '%')
					</if>
					<if test="f == 6">	
						AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_MST X1, PRODUCT_MODEL_DTL X2 
						 		    WHERE X1.SEQ = X2.SEQ 
						 		      AND X1.PROD_CD = B.PROD_CD 
						 		      AND X1.PROD_KIND = B.PROD_MODEL_KIND 
							 		  AND X2.MODEL_CD = B.PROD_MODEL_CD 
							 		  AND X1.DEL_FG = 'N' 
							 		  AND X2.MODEL_NM LIKE '%' || #{q} || '%')
					</if>				
					<if test="f == 7">	
						AND F.NOTE LIKE '%' || #{q} || '%'
					</if>
					<if test="f == 8">	
						AND E.COM_NM LIKE '%' || #{q} || '%'
					</if>
				</if>
				<if test="f == 9">	
					AND F.ORDER_DT IS NULL
				</if>
				<if test="f == 10">
					AND F.DELIVERY_DT IS NULL
				</if>
				<if test="f == 11">
					AND F.HOLD_DT IS NULL
				</if>
				<if test="f == 12">
					AND F.ORDER_DT IS NOT NULL
				</if>
				<if test="cancelViewYn == null">
					AND DECODE(FN_ACCNT_STAT(B.ACCNT_NO), 'Y', '정상', 'R', '해약', 'E', '행사', '청약철회')  != '청약철회'
				</if>

				</foreach>
				</if>


		<if test="idList == null">

				SELECT #{id} AS ADM_ID, A.MEM_NM, A.CELL, A.HOME_ADDR, A.HOME_ADDR2, A.NOTE AS NOTE2, B.ACCNT_NO
				, B.JOIN_DT, B.PROD_CD, B.PROD_KIND, B.PROD_MODEL_KIND, B.INSPL_ZIP, B.INSPL_ADDR, B.INSPL_ADDR2, B.INSPL_PHONE, B.ORDER_NUM, B.B2B_EMPLE_NO
				, F.ORDER_DT, F.CONFIRM_DT, F.DELIVERY_DT, F.HOLD_DT, F.UPDATE_CELL, F.UPDATE_ADDR, E.COM_NM AS B2B_COMP_NM, F.UPDATE_TYPE, F.NOTE, F.HPCALL_YN, F.ETC
				<choose>
					<when test="orderdateMng == 'Y'.toString()">
						, B.KB_NO
						, FN_MODEL_CL_NM(B.PROD_MODEL_KIND) AS PROD_MODEL
						, (SELECT X2.MODEL_NM
						FROM PRODUCT_MODEL_MST X1, PRODUCT_MODEL_DTL X2
						WHERE X1.SEQ = X2.SEQ
						AND X1.DEL_FG = 'N'
						AND X1.PROD_CD = B.PROD_CD
						AND X1.PROD_KIND = B.PROD_MODEL_KIND
						AND X2.MODEL_CD = B.PROD_MODEL_CD) AS PROD_MODEL_NM
						, F.UPDATE_PADDR
						, F.NOSETUP_ETC
					</when>
					<otherwise>
						, B.KB_NO
						, FN_MODEL_CL_NM(B.PROD_MODEL_KIND) AS PROD_MODEL
						, (SELECT X2.MODEL_NM
						FROM PRODUCT_MODEL_MST X1, PRODUCT_MODEL_DTL X2
						WHERE X1.SEQ = X2.SEQ
						AND X1.DEL_FG = 'N'
						AND X1.PROD_CD = B.PROD_CD
						AND X1.PROD_KIND = B.PROD_MODEL_KIND
						AND X2.MODEL_CD = B.PROD_MODEL_CD) AS PROD_MODEL_NM
						, F.UPDATE_PADDR
						, F.NOSETUP_ETC
					</otherwise>
				</choose>

				FROM MEMBER A, MEM_PROD_ACCNT B, PRODUCT C, B2BCOMCD E, DELIVERY_INFO F
				WHERE A.MEM_NO = B.MEM_NO
				AND B.PROD_CD = C.PROD_CD
				AND B.B2B_COMP_CD = E.COM_CD(+)

				<choose>
					<when test="orderdateMng == 'Y'.toString()">
						AND B.ACCNT_NO = F.ACCNT_NO(+)
					</when>
					<otherwise>
						AND B.ACCNT_NO = F.ACCNT_NO
					</otherwise>
				</choose>

				AND A.DEL_FG = 'N'
				AND B.DEL_FG = 'N'
				AND EXISTS(SELECT 'X' FROM PAY_MNG WHERE DEL_FG = 'N' AND ACCNT_NO = B.ACCNT_NO)

				<if test="id == 'lgorder'">
					AND (	(C.SECTION_THR IN ('0001','0006','0014') AND C.SECTION_T = '0002')
					OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
					OR (C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
					OR (C.SECTION_THR = '0021' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
					OR (C.SECTION_THR = '0026' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
					OR (C.SECTION_THR = '0025' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
					OR (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
					OR (C.SECTION_THR = '0008' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
					OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
					OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG')))
				</if>
				<if test="id == 'csvorder'">
					AND ((C.SECTION_THR IN ('0002','0015') AND C.SECTION_F != '0002')
					OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
					OR (C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
					OR (C.SECTION_THR = '0021' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
					OR (C.SECTION_THR = '0026' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
					OR (C.SECTION_THR = '0025' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
					OR (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
					OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
					OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS')))
				</if>
				<if test="id == 'dhorder'">
					AND ((C.SECTION_THR = '0012' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
					OR (C.SECTION_THR = '0017' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
					OR (C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
					OR (C.SECTION_THR = '0021' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
					OR (C.SECTION_THR = '0026' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
					OR (C.SECTION_THR = '0025' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
					OR (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
					OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
					OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
					OR (C.SECTION_THR = '0031' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
					OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH')))
				</if>
				<if test="id == 'isollat' or id == 'isorder'">
					AND (
					(C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER IN ( 'isollat', 'isorder' ) ))
					OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER IN ( 'isollat', 'isorder') ))
					)
				</if>
				<if test="id == 'sonoseason'">
					AND (
					(C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'sono'))
					OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'sono'))
					OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'sono'))
					)
				</if>
				<if test="id == 'wmnetwork'">
					AND (
					(C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'wmnet'))
					OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'wmnet'))
					OR (C.SECTION_THR = '0021' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'wmnet'))
					OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'wmnet'))
					)
				</if>

				<if test="id == 'mmorder'">
					AND (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LU'))
				</if>
				<choose>
					<when test="orderdateMng == 'Y'.toString()">
						<if test="id == 'dyorder'">
							AND (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DY'))
						</if>
					</when>
					<otherwise>
						<if test="id == 'dyorder'">
							AND (F.B2B_STAT = 'DONGYANG'
							AND C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DY'))
						</if>
					</otherwise>
				</choose>

				<if test="daysel != null and daysel !=''">
					<if test="strtDt != null and strtDt != '' and endDt != null and endDt != ''">
						<if test="daysel == 'orderDt'">
							AND F.ORDER_DT <![CDATA[>=]]> REPLACE(#{strtDt}, '-', '')
							AND F.ORDER_DT <![CDATA[<=]]> REPLACE(#{endDt}, '-', '')
						</if>
						<if test="daysel == 'joinDt'">
							AND B.JOIN_DT <![CDATA[>=]]> REPLACE(#{strtDt}, '-', '')
							AND B.JOIN_DT <![CDATA[<=]]> REPLACE(#{endDt}, '-', '')
						</if>
						<if test="daysel == 'rescc'">
							AND EXISTS(SELECT 'X' FROM RESCISSION WHERE DEL_FG = 'N' AND ACCNT_NO = B.ACCNT_NO AND RESN_PROC_DAY <![CDATA[>=]]> REPLACE(#{strtDt}, '-', '') AND RESN_PROC_DAY <![CDATA[<=]]> REPLACE(#{endDt}, '-', ''))
						</if>
						<if test="daysel == 'orderChk'">
							AND REPLACE(F.UPDATE_ADDR, ' ', '') != REPLACE(B.INSPL_ZIP || ')' || B.INSPL_ADDR || B.INSPL_ADDR2, ' ', '')
							AND F.UPDATE_TYPE != (SELECT PROD_KIND_NM FROM PRODUCT_KIND WHERE SEQ = B.PROD_KIND AND MODEL_CL_CD = B.PROD_MODEL_KIND)
							AND F.UPDATE_CELL != A.CELL
							AND F.ORDER_DT <![CDATA[>=]]> REPLACE(#{strtDt}, '-', '')
							AND F.ORDER_DT <![CDATA[<=]]> REPLACE(#{endDt}, '-', '')
						</if>
						<if test="daysel == 'confirmDt'">
							AND F.CONFIRM_DT <![CDATA[>=]]> REPLACE(#{strtDt}, '-', '')
							AND F.CONFIRM_DT <![CDATA[<=]]> REPLACE(#{endDt}, '-', '')
						</if>
						<if test="daysel == 'deliveryDt'">
							AND F.DELIVERY_DT <![CDATA[>=]]> REPLACE(#{strtDt}, '-', '')
							AND F.DELIVERY_DT <![CDATA[<=]]> REPLACE(#{endDt}, '-', '')
						</if>
						<if test="daysel == 'holdDt'">
							AND F.HOLD_DT <![CDATA[>=]]> REPLACE(#{strtDt}, '-', '')
							AND F.HOLD_DT <![CDATA[<=]]> REPLACE(#{endDt}, '-', '')
						</if>
						<if test="daysel == 'allAccnt'">
							AND MEM_NM IN (
							SELECT MEM_NM
							FROM MEMBER A, MEM_PROD_ACCNT B, PRODUCT C, DELIVERY_INFO D
							WHERE A.MEM_NO = B.MEM_NO
							AND B.PROD_CD = C.PROD_CD
							AND B.ACCNT_NO = D.ACCNT_NO
							AND A.DEL_FG = 'N'
							AND B.DEL_FG = 'N'
							<if test="id == 'lgorder'">
								AND (	(C.SECTION_THR IN ('0001','0006','0014') AND C.SECTION_T = '0002')
								OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
								OR (C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
								OR (C.SECTION_THR = '0021' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
								OR (C.SECTION_THR = '0026' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
								OR (C.SECTION_THR = '0025' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
								OR (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
								OR (C.SECTION_THR = '0008' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
								OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
								OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG')))
							</if>
							<if test="id == 'csvorder'">
								AND ((C.SECTION_THR IN ('0002','0015') AND C.SECTION_F != '0002')
								OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
								OR (C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
								OR (C.SECTION_THR = '0021' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
								OR (C.SECTION_THR = '0026' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
								OR (C.SECTION_THR = '0025' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
								OR (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
								OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
								OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS')))
							</if>
							<if test="id == 'dhorder'">
								AND ((C.SECTION_THR = '0012' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
								OR (C.SECTION_THR = '0017' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
								OR (C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
								OR (C.SECTION_THR = '0021' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
								OR (C.SECTION_THR = '0026' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
								OR (C.SECTION_THR = '0025' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
								OR (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
								OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
								OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
								OR (C.SECTION_THR = '0031' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
								OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH')))
							</if>
							<if test="id == 'isollat' or id == 'isorder'">
								AND (
								(C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER IN ( 'isollat', 'isorder' ) ))
								OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER IN ( 'isollat', 'isorder') ))
								)
							</if>

							<if test="id == 'sonoseason'">
								AND (
								(C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'sono'))
								OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'sono'))
								OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'sono'))
								)
							</if>

							<if test="id == 'wmnetwork'">
								AND (
								(C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'wmnet'))
								OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'wmnet'))
								OR (C.SECTION_THR = '0021' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'wmnet'))
								OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'wmnet'))
								)
							</if>

							<if test="id == 'mmorder'">
								AND (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LU'))
							</if>
							<if test="id == 'dyorder'">
								AND C.PROD_GUBUN IN ('0024', '0025', '0027')
							</if>
							AND D.ORDER_DT <![CDATA[>=]]> REPLACE(#{strtDt}, '-', '')
							AND D.ORDER_DT <![CDATA[<=]]> REPLACE(#{endDt}, '-', '')
							GROUP BY A.MEM_NM, A.CELL
							HAVING COUNT(A.MEM_NM) <![CDATA[>]]> 1
							)
						</if>
						<if test="daysel == 'noSetup'">
							AND TRUNC(TO_DATE(F.ORDER_DT, 'yyyyMMdd') - SYSDATE) <![CDATA[>=]]> 32
							AND F.DELIVERY_DT IS NULL
							AND FN_ACCNT_STAT(TBL.ACCNT_NO) NOT IN('Y', 'R', 'E')
						</if>
					</if>
				</if>
				<if test="q != null and q != ''">
					<if test="f == 1">
						AND A.MEM_NM LIKE '%' || #{q} || '%'
					</if>
					<if test="f == 2">
						AND B.ACCNT_NO = #{q}
					</if>
					<if test="f == 3">
						AND NVL(F.UPDATE_CELL, A.CELL) = #{q}
					</if>
					<if test="f == 4">
						AND EXISTS(SELECT 'X' FROM PRODUCT WHERE PROD_CD = B.PROD_CD AND PROD_NM LIKE '%' || #{q} || '%')
					</if>
					<if test="f == 5">
						AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND MODEL_CL_NM LIKE '%' || #{q} || '%')
					</if>
					<if test="f == 6">
						AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_MST X1, PRODUCT_MODEL_DTL X2
						WHERE X1.SEQ = X2.SEQ
						AND X1.PROD_CD = B.PROD_CD
						AND X1.PROD_KIND = B.PROD_MODEL_KIND
						AND X2.MODEL_CD = B.PROD_MODEL_CD
						AND X1.DEL_FG = 'N'
						AND X2.MODEL_NM LIKE '%' || #{q} || '%')
					</if>
					<if test="f == 7">
						AND F.NOTE LIKE '%' || #{q} || '%'
					</if>
					<if test="f == 8">
						AND E.COM_NM LIKE '%' || #{q} || '%'
					</if>
				</if>
				<if test="f == 9">
					AND F.ORDER_DT IS NULL
				</if>
				<if test="f == 10">
					AND F.DELIVERY_DT IS NULL
				</if>
				<if test="f == 11">
					AND F.HOLD_DT IS NULL
				</if>
				<if test="f == 12">
					AND F.ORDER_DT IS NOT NULL
				</if>
				<if test="cancelViewYn == null">
					AND DECODE(FN_ACCNT_STAT(B.ACCNT_NO), 'Y', '정상', 'R', '해약', 'E', '행사', '청약철회')  != '청약철회'
				</if>

		</if>
				 ORDER BY JOIN_DT DESC, MEM_NM
			) T1
		) TBL
		WHERE RNUM BETWEEN #{firstIndex} + 1 AND #{firstIndex} + #{recordCountPerPage}	  	     
	</select>

	<select id="OMBOrderMngDAO.selectOrderMngListCnt" parameterType="emfMap" resultType="emfMap">
		<choose>
		<when test="idList != null">

			SELECT SUM(CNT) CNT
			FROM (
		<foreach collection="idList" item="id" open="(" separator=") UNION ALL (" close=")">
			SELECT /* OMBOrderMngDAO.selectOrderMngListCnt */
			COUNT(*) AS
			CNT
			FROM
			MEMBER A, MEM_PROD_ACCNT B, PRODUCT C, B2BCOMCD E, DELIVERY_INFO F
			WHERE A.MEM_NO = B.MEM_NO
			AND B.PROD_CD = C.PROD_CD
			AND B.B2B_COMP_CD = E.COM_CD(+)
		<choose>
			<when test="orderdateMng == 'Y'.toString()">
				AND B.ACCNT_NO = F.ACCNT_NO(+)
			</when>
			<otherwise>
				AND B.ACCNT_NO = F.ACCNT_NO
			</otherwise>	
		</choose>
		
		   AND A.DEL_FG = 'N'
		   AND B.DEL_FG = 'N'
		   AND EXISTS(SELECT 'X' FROM PAY_MNG WHERE DEL_FG = 'N' AND ACCNT_NO = B.ACCNT_NO)
		 
		<if test="id == 'lgorder'">
			AND (	(C.SECTION_THR IN ('0001','0006','0014') AND C.SECTION_T = '0002') 
				OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
				OR (C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG')) 
				OR (C.SECTION_THR = '0021' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG')) 
				OR (C.SECTION_THR = '0026' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG')) 
				OR (C.SECTION_THR = '0025' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG')) 
				OR (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG')) 
				OR (C.SECTION_THR = '0008' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
				OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG')) 
				OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG')))
		</if>		
		<if test="id == 'csvorder'">
			AND ((C.SECTION_THR IN ('0002','0015') AND C.SECTION_F != '0002') 
			OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
			OR (C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS')) 
			OR (C.SECTION_THR = '0021' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS')) 
			OR (C.SECTION_THR = '0026' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS')) 
			OR (C.SECTION_THR = '0025' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
			OR (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
			OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS')) 
			OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))) 
		</if>
		<if test="id == 'dhorder'">
			AND ((C.SECTION_THR = '0012' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH')) 
			OR (C.SECTION_THR = '0017' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH')) 
			OR (C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
			OR (C.SECTION_THR = '0021' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
			OR (C.SECTION_THR = '0026' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH')) 
			OR (C.SECTION_THR = '0025' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
			OR (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
			OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH')) 
			OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
			OR (C.SECTION_THR = '0031' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH')) 
       		OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))) 
		</if>

		<if test="id == 'isollat' or id == 'isorder'">
			AND (
			(C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER IN ( 'isollat', 'isorder' ) ))
			OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER IN ( 'isollat', 'isorder') ))
			)
		</if>
		
		<if test="id == 'sonoseason'">
			AND (
			(C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'sono'))
			OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'sono'))
			OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'sono'))
			) 
		</if>
		
		<if test="id == 'wmnetwork'">
			AND (
			(C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'wmnet'))
			OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'wmnet'))
			OR (C.SECTION_THR = '0021' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'wmnet'))
			OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'wmnet'))
			) 
		</if>
		
		<if test="id == 'mmorder'">
					AND (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LU'))
		</if>	

		<choose>
			<when test="orderdateMng == 'Y'.toString()">
				<if test="id == 'dyorder'">
					AND (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE
					MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DY'))
				</if>					
			</when>
			<otherwise>
				<if test="id == 'dyorder'">
					AND (F.B2B_STAT = 'DONGYANG'
					AND C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE
					MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DY'))
				</if>					
			</otherwise>	
		</choose>
				
<!-- 
		<choose>
			<when test="orderdateMng == 'Y'.toString()">
				<if test="id == 'dyorder'">
					AND (C.PROD_GUBUN = '0028' 
					OR (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LV'))
         			OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LV')))
				</if>					
			</when>
			<otherwise>
				<if test="id == 'dyorder'">
					AND F.B2B_STAT = 'DONGYANG'
				</if>					
			</otherwise>	
		</choose>
 -->
		<if test="daysel != null and daysel !=''">		
			<if test="strtDt != null and strtDt != '' and endDt != null and endDt != ''">
				<if test="daysel == 'orderDt'">						
					AND F.ORDER_DT <![CDATA[>=]]> REPLACE(#{strtDt}, '-', '')
					AND F.ORDER_DT <![CDATA[<=]]> REPLACE(#{endDt}, '-', '')
				</if>
				<if test="daysel == 'joinDt'">
					AND B.JOIN_DT <![CDATA[>=]]> REPLACE(#{strtDt}, '-', '')
					AND B.JOIN_DT <![CDATA[<=]]> REPLACE(#{endDt}, '-', '')
				</if>
				<if test="daysel == 'rescc'">
					AND EXISTS(SELECT 'X' FROM RESCISSION WHERE DEL_FG = 'N' AND ACCNT_NO = B.ACCNT_NO
					AND RESN_PROC_DAY <![CDATA[>=]]> REPLACE(#{strtDt}, '-', '') AND RESN_PROC_DAY <![CDATA[<=]]>
					REPLACE(#{endDt}, '-', ''))
				</if>
				<if test="daysel == 'orderChk'">
					AND REPLACE(F.UPDATE_ADDR, ' ', '') != REPLACE(B.INSPL_ZIP || ')' || B.INSPL_ADDR
					|| B.INSPL_ADDR2, ' ', '')
					AND F.UPDATE_TYPE != (SELECT PROD_KIND_NM FROM PRODUCT_KIND WHERE SEQ = B.PROD_KIND
					AND MODEL_CL_CD = B.PROD_MODEL_KIND)
					AND F.UPDATE_CELL != A.CELL
					AND F.ORDER_DT <![CDATA[>=]]> REPLACE(#{strtDt}, '-', '')
					AND F.ORDER_DT <![CDATA[<=]]> REPLACE(#{endDt}, '-', '')
				</if>
				<if test="daysel == 'confirmDt'">
					AND F.CONFIRM_DT <![CDATA[>=]]> REPLACE(#{strtDt}, '-', '')
					AND F.CONFIRM_DT <![CDATA[<=]]> REPLACE(#{endDt}, '-', '')
				</if>
				<if test="daysel == 'deliveryDt'">
					AND F.DELIVERY_DT <![CDATA[>=]]> REPLACE(#{strtDt}, '-', '')
					AND F.DELIVERY_DT <![CDATA[<=]]> REPLACE(#{endDt}, '-', '')
				</if>
				<if test="daysel == 'holdDt'">
					AND F.HOLD_DT <![CDATA[>=]]> REPLACE(#{strtDt}, '-', '')
					AND F.HOLD_DT <![CDATA[<=]]> REPLACE(#{endDt}, '-', '')
				</if>
				<if test="daysel == 'allAccnt'">
					AND MEM_NM IN (
						SELECT MEM_NM 
						  FROM MEMBER A, MEM_PROD_ACCNT B, PRODUCT C, DELIVERY_INFO D
						 WHERE A.MEM_NO = B.MEM_NO
						   AND B.PROD_CD = C.PROD_CD
						   AND B.ACCNT_NO = D.ACCNT_NO
						   AND A.DEL_FG = 'N'
						   AND B.DEL_FG = 'N'
						<if test="id == 'lgorder'">
							AND ( (C.SECTION_THR IN ('0001','0006','0014') AND C.SECTION_T = '0002')
							OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
							WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
							OR (C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
							WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
							OR (C.SECTION_THR = '0021' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
							WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
							OR (C.SECTION_THR = '0026' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
							WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
							OR (C.SECTION_THR = '0025' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
							WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
							OR (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
							WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
							OR (C.SECTION_THR = '0008' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
							WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
							OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
							WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
							OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
							WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG')))
						</if>		
						<if test="id == 'csvorder'">
							AND ((C.SECTION_THR IN ('0002','0015') AND C.SECTION_F != '0002')
							OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
							WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
							OR (C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
							WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
							OR (C.SECTION_THR = '0021' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
							WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
							OR (C.SECTION_THR = '0026' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
							WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
							OR (C.SECTION_THR = '0025' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
							WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
							OR (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
							WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
							OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
							WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
							OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
							WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS')))
						</if>
						<if test="id == 'dhorder'">
							AND ((C.SECTION_THR = '0012' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
							WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
							OR (C.SECTION_THR = '0017' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
							WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
							OR (C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
							WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
							OR (C.SECTION_THR = '0021' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
							WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
							OR (C.SECTION_THR = '0026' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
							WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
							OR (C.SECTION_THR = '0025' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
							WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
							OR (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
							WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
							OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
							WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
							OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
							WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
							OR (C.SECTION_THR = '0031' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
							WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
							OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
							WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH')))
						</if>
						<if test="id == 'isollat' or id =='isorder' ">
							AND (
							(C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE
							MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER IN ('isollat', 'isorder') ))
							OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
							WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER IN ('isollat', 'isorder') ))
							)
						</if>
						<if test="id == 'sonoseason'">
							AND (
							(C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE
							MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'sono'))
							OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
							WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'sono'))
							OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
							WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'sono'))
							)
						</if>
						<if test="id == 'wmnetwork'">
							AND (
							(C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE
							MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'wmnet'))
							OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
							WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'wmnet'))
							OR (C.SECTION_THR = '0021' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
							WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'wmnet'))
							OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
							WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'wmnet'))
							)
						</if>
						<if test="id == 'mmorder'">
							AND (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
							WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LU'))
						</if>
						<if test="id == 'dyorder'">
							AND C.PROD_GUBUN IN ('0024', '0025', '0027')
						</if>
						   AND D.ORDER_DT <![CDATA[>=]]> REPLACE(#{strtDt}, '-', '')
						   AND D.ORDER_DT <![CDATA[<=]]> REPLACE(#{endDt}, '-', '')
						 GROUP BY A.MEM_NM, A.CELL 
						HAVING COUNT(A.MEM_NM) <![CDATA[>]]> 1
					)
				</if>
				<if test="daysel == 'noSetup'">
					AND TRUNC(TO_DATE(F.ORDER_DT, 'yyyyMMdd') - SYSDATE) <![CDATA[>=]]> 32 
					AND F.DELIVERY_DT IS NULL 
					AND FN_ACCNT_STAT(TBL.ACCNT_NO) NOT IN('Y', 'R', 'E')
				</if>
			</if>
		</if>
		<if test="q != null and q != ''">	
			<if test="f == 1">	
				AND A.MEM_NM LIKE '%' || #{q} || '%'
			</if>
			<if test="f == 2">	
				AND B.ACCNT_NO = #{q}
			</if>
			<if test="f == 3">	
				AND NVL(F.UPDATE_CELL, A.CELL) = #{q}
			</if>
			<if test="f == 4">
				AND EXISTS(SELECT 'X' FROM PRODUCT WHERE PROD_CD = B.PROD_CD AND PROD_NM LIKE '%' || #{q}
				|| '%')
			</if>
			<if test="f == 5">
				AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND
				AND MODEL_CL_NM LIKE '%' || #{q} || '%')
			</if>
			<if test="f == 6">	
				AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_MST X1, PRODUCT_MODEL_DTL X2 
				 		    WHERE X1.SEQ = X2.SEQ 
				 		      AND X1.PROD_CD = B.PROD_CD 
				 		      AND X1.PROD_KIND = B.PROD_MODEL_KIND 
					 		  AND X2.MODEL_CD = B.PROD_MODEL_CD 
					 		  AND X1.DEL_FG = 'N' 
					 		  AND X2.MODEL_NM LIKE '%' || #{q} || '%')
			</if>				
			<if test="f == 7">	
				AND F.NOTE LIKE '%' || #{q} || '%'
			</if>
			<if test="f == 8">	
				AND E.COM_NM LIKE '%' || #{q} || '%'
			</if>
		</if>
		<if test="f == 9">	
			AND F.ORDER_DT IS NULL
		</if>
		<if test="f == 10">
			AND F.DELIVERY_DT IS NULL
		</if>
		<if test="f == 11">
			AND F.HOLD_DT IS NULL
		</if>
		<if test="f == 12">
			AND F.ORDER_DT IS NOT NULL
		</if>
		<if test="cancelViewYn == null">
			AND DECODE(FN_ACCNT_STAT(B.ACCNT_NO), 'Y', '정상', 'R', '해약', 'E', '행사', '청약철회')  != '청약철회'
		</if>
		</foreach>
			)
		</when>
			<otherwise>

					SELECT /* OMBOrderMngDAO.selectOrderMngListCnt */
					COUNT(*) AS
					CNT
					FROM
					MEMBER A, MEM_PROD_ACCNT B, PRODUCT C, B2BCOMCD E, DELIVERY_INFO F
					WHERE A.MEM_NO = B.MEM_NO
					AND B.PROD_CD = C.PROD_CD
					AND B.B2B_COMP_CD = E.COM_CD(+)
					<choose>
						<when test="orderdateMng == 'Y'.toString()">
							AND B.ACCNT_NO = F.ACCNT_NO(+)
						</when>
						<otherwise>
							AND B.ACCNT_NO = F.ACCNT_NO
						</otherwise>
					</choose>

					AND A.DEL_FG = 'N'
					AND B.DEL_FG = 'N'
					AND EXISTS(SELECT 'X' FROM PAY_MNG WHERE DEL_FG = 'N' AND ACCNT_NO = B.ACCNT_NO)

					<if test="id == 'lgorder'">
						AND (	(C.SECTION_THR IN ('0001','0006','0014') AND C.SECTION_T = '0002')
						OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
						OR (C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
						OR (C.SECTION_THR = '0021' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
						OR (C.SECTION_THR = '0026' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
						OR (C.SECTION_THR = '0025' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
						OR (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
						OR (C.SECTION_THR = '0008' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
						OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
						OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG')))
					</if>
					<if test="id == 'csvorder'">
						AND ((C.SECTION_THR IN ('0002','0015') AND C.SECTION_F != '0002')
						OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
						OR (C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
						OR (C.SECTION_THR = '0021' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
						OR (C.SECTION_THR = '0026' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
						OR (C.SECTION_THR = '0025' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
						OR (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
						OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
						OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS')))
					</if>
					<if test="id == 'dhorder'">
						AND ((C.SECTION_THR = '0012' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
						OR (C.SECTION_THR = '0017' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
						OR (C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
						OR (C.SECTION_THR = '0021' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
						OR (C.SECTION_THR = '0026' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
						OR (C.SECTION_THR = '0025' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
						OR (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
						OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
						OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
						OR (C.SECTION_THR = '0031' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
						OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH')))
					</if>

				<if test="id == 'isollat' or id == 'isorder'">
					AND (
					(C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER IN ( 'isollat', 'isorder' ) ))
					OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER IN ( 'isollat', 'isorder') ))
					)
				</if>


					<if test="id == 'sonoseason'">
						AND (
						(C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'sono'))
						OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'sono'))
						OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'sono'))
						)
					</if>

					<if test="id == 'wmnetwork'">
						AND (
						(C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'wmnet'))
						OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'wmnet'))
						OR (C.SECTION_THR = '0021' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'wmnet'))
						OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'wmnet'))
						)
					</if>

					<if test="id == 'mmorder'">
						AND (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LU'))
					</if>

					<choose>
						<when test="orderdateMng == 'Y'.toString()">
							<if test="id == 'dyorder'">
								AND (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE
								MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DY'))
							</if>
						</when>
						<otherwise>
							<if test="id == 'dyorder'">
								AND (F.B2B_STAT = 'DONGYANG'
								AND C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE
								MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DY'))
							</if>
						</otherwise>
					</choose>

					<!--
                            <choose>
                                <when test="orderdateMng == 'Y'.toString()">
                                    <if test="id == 'dyorder'">
                                        AND (C.PROD_GUBUN = '0028'
                                        OR (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LV'))
                                         OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LV')))
                                    </if>
                                </when>
                                <otherwise>
                                    <if test="id == 'dyorder'">
                                        AND F.B2B_STAT = 'DONGYANG'
                                    </if>
                                </otherwise>
                            </choose>
                     -->
					<if test="daysel != null and daysel !=''">
						<if test="strtDt != null and strtDt != '' and endDt != null and endDt != ''">
							<if test="daysel == 'orderDt'">
								AND F.ORDER_DT <![CDATA[>=]]> REPLACE(#{strtDt}, '-', '')
								AND F.ORDER_DT <![CDATA[<=]]> REPLACE(#{endDt}, '-', '')
							</if>
							<if test="daysel == 'joinDt'">
								AND B.JOIN_DT <![CDATA[>=]]> REPLACE(#{strtDt}, '-', '')
								AND B.JOIN_DT <![CDATA[<=]]> REPLACE(#{endDt}, '-', '')
							</if>
							<if test="daysel == 'rescc'">
								AND EXISTS(SELECT 'X' FROM RESCISSION WHERE DEL_FG = 'N' AND ACCNT_NO = B.ACCNT_NO
								AND RESN_PROC_DAY <![CDATA[>=]]> REPLACE(#{strtDt}, '-', '') AND RESN_PROC_DAY <![CDATA[<=]]>
								REPLACE(#{endDt}, '-', ''))
							</if>
							<if test="daysel == 'orderChk'">
								AND REPLACE(F.UPDATE_ADDR, ' ', '') != REPLACE(B.INSPL_ZIP || ')' || B.INSPL_ADDR
								|| B.INSPL_ADDR2, ' ', '')
								AND F.UPDATE_TYPE != (SELECT PROD_KIND_NM FROM PRODUCT_KIND WHERE SEQ = B.PROD_KIND
								AND MODEL_CL_CD = B.PROD_MODEL_KIND)
								AND F.UPDATE_CELL != A.CELL
								AND F.ORDER_DT <![CDATA[>=]]> REPLACE(#{strtDt}, '-', '')
								AND F.ORDER_DT <![CDATA[<=]]> REPLACE(#{endDt}, '-', '')
							</if>
							<if test="daysel == 'confirmDt'">
								AND F.CONFIRM_DT <![CDATA[>=]]> REPLACE(#{strtDt}, '-', '')
								AND F.CONFIRM_DT <![CDATA[<=]]> REPLACE(#{endDt}, '-', '')
							</if>
							<if test="daysel == 'deliveryDt'">
								AND F.DELIVERY_DT <![CDATA[>=]]> REPLACE(#{strtDt}, '-', '')
								AND F.DELIVERY_DT <![CDATA[<=]]> REPLACE(#{endDt}, '-', '')
							</if>
							<if test="daysel == 'holdDt'">
								AND F.HOLD_DT <![CDATA[>=]]> REPLACE(#{strtDt}, '-', '')
								AND F.HOLD_DT <![CDATA[<=]]> REPLACE(#{endDt}, '-', '')
							</if>
							<if test="daysel == 'allAccnt'">
								AND MEM_NM IN (
								SELECT MEM_NM
								FROM MEMBER A, MEM_PROD_ACCNT B, PRODUCT C, DELIVERY_INFO D
								WHERE A.MEM_NO = B.MEM_NO
								AND B.PROD_CD = C.PROD_CD
								AND B.ACCNT_NO = D.ACCNT_NO
								AND A.DEL_FG = 'N'
								AND B.DEL_FG = 'N'
								<if test="id == 'lgorder'">
									AND ( (C.SECTION_THR IN ('0001','0006','0014') AND C.SECTION_T = '0002')
									OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
									WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
									OR (C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
									WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
									OR (C.SECTION_THR = '0021' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
									WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
									OR (C.SECTION_THR = '0026' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
									WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
									OR (C.SECTION_THR = '0025' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
									WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
									OR (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
									WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
									OR (C.SECTION_THR = '0008' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
									WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
									OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
									WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
									OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
									WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG')))
								</if>
								<if test="id == 'csvorder'">
									AND ((C.SECTION_THR IN ('0002','0015') AND C.SECTION_F != '0002')
									OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
									WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
									OR (C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
									WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
									OR (C.SECTION_THR = '0021' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
									WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
									OR (C.SECTION_THR = '0026' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
									WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
									OR (C.SECTION_THR = '0025' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
									WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
									OR (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
									WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
									OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
									WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
									OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
									WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS')))
								</if>
								<if test="id == 'dhorder'">
									AND ((C.SECTION_THR = '0012' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
									WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
									OR (C.SECTION_THR = '0017' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
									WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
									OR (C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
									WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
									OR (C.SECTION_THR = '0021' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
									WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
									OR (C.SECTION_THR = '0026' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
									WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
									OR (C.SECTION_THR = '0025' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
									WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
									OR (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
									WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
									OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
									WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
									OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
									WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
									OR (C.SECTION_THR = '0031' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
									WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
									OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
									WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH')))
								</if>
								<if test="id == 'isollat' or id =='isorder' ">
									AND (
									(C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE
									MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER IN ('isollat', 'isorder') ))
									OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
									WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER IN ('isollat', 'isorder') ))
									)
								</if>
								<if test="id == 'sonoseason'">
									AND (
									(C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE
									MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'sono'))
									OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
									WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'sono'))
									OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
									WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'sono'))
									)
								</if>
								<if test="id == 'wmnetwork'">
									AND (
									(C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE
									MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'wmnet'))
									OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
									WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'wmnet'))
									OR (C.SECTION_THR = '0021' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
									WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'wmnet'))
									OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
									WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'wmnet'))
									)
								</if>
								<if test="id == 'mmorder'">
									AND (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD
									WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LU'))
								</if>
								<if test="id == 'dyorder'">
									AND C.PROD_GUBUN IN ('0024', '0025', '0027')
								</if>
								AND D.ORDER_DT <![CDATA[>=]]> REPLACE(#{strtDt}, '-', '')
								AND D.ORDER_DT <![CDATA[<=]]> REPLACE(#{endDt}, '-', '')
								GROUP BY A.MEM_NM, A.CELL
								HAVING COUNT(A.MEM_NM) <![CDATA[>]]> 1
								)
							</if>
							<if test="daysel == 'noSetup'">
								AND TRUNC(TO_DATE(F.ORDER_DT, 'yyyyMMdd') - SYSDATE) <![CDATA[>=]]> 32
								AND F.DELIVERY_DT IS NULL
								AND FN_ACCNT_STAT(TBL.ACCNT_NO) NOT IN('Y', 'R', 'E')
							</if>
						</if>
					</if>
					<if test="q != null and q != ''">
						<if test="f == 1">
							AND A.MEM_NM LIKE '%' || #{q} || '%'
						</if>
						<if test="f == 2">
							AND B.ACCNT_NO = #{q}
						</if>
						<if test="f == 3">
							AND NVL(F.UPDATE_CELL, A.CELL) = #{q}
						</if>
						<if test="f == 4">
							AND EXISTS(SELECT 'X' FROM PRODUCT WHERE PROD_CD = B.PROD_CD AND PROD_NM LIKE '%' || #{q}
							|| '%')
						</if>
						<if test="f == 5">
							AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND
							AND MODEL_CL_NM LIKE '%' || #{q} || '%')
						</if>
						<if test="f == 6">
							AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_MST X1, PRODUCT_MODEL_DTL X2
							WHERE X1.SEQ = X2.SEQ
							AND X1.PROD_CD = B.PROD_CD
							AND X1.PROD_KIND = B.PROD_MODEL_KIND
							AND X2.MODEL_CD = B.PROD_MODEL_CD
							AND X1.DEL_FG = 'N'
							AND X2.MODEL_NM LIKE '%' || #{q} || '%')
						</if>
						<if test="f == 7">
							AND F.NOTE LIKE '%' || #{q} || '%'
						</if>
						<if test="f == 8">
							AND E.COM_NM LIKE '%' || #{q} || '%'
						</if>
					</if>
					<if test="f == 9">
						AND F.ORDER_DT IS NULL
					</if>
					<if test="f == 10">
						AND F.DELIVERY_DT IS NULL
					</if>
					<if test="f == 11">
						AND F.HOLD_DT IS NULL
					</if>
					<if test="f == 12">
						AND F.ORDER_DT IS NOT NULL
					</if>
					<if test="cancelViewYn == null">
						AND DECODE(FN_ACCNT_STAT(B.ACCNT_NO), 'Y', '정상', 'R', '해약', 'E', '행사', '청약철회')  != '청약철회'
					</if>
			</otherwise>
		</choose>


	</select>

	<!--
         쿼리명 : OMBOrderMngDAO.selectOrderMngExcelList
         설  명 : 외주업체 발주관리 목록을 엑셀 다운한다.
       	  수정일     수정자      수정내용 
        ==========   ======   ============== 
        2016.03.21   김필기     최초 생성
		2018.07.20   한상민     mmoder 계정 전체 수정
    -->
    <select id="OMBOrderMngDAO.selectOrderMngExcelList" parameterType="emfMap" resultType="emfMap">
		SELECT /* OMBOrderMngDAO.selectOrderMngExcelList */ 
		       TBL.* 
		       , FN_PROD_NM(TBL.PROD_CD) AS PROD_NM
		       , (SELECT PROD_KIND_NM FROM PRODUCT_KIND WHERE SEQ = TBL.PROD_KIND AND MODEL_CL_CD = TBL.PROD_MODEL_KIND) AS PROD_KIND_NM
			   , DECODE(FN_ACCNT_STAT(TBL.ACCNT_NO), 'Y', '정상', 'R', '해약', 'E', '행사', '청약철회') AS ACC_STAT
		FROM (
			SELECT ROWNUM AS RNUM, T1.*
			FROM (
				<choose>
				<when test="idList != null">
				<foreach collection="idList" item="id" open="(" separator=") UNION ALL (" close=")">
				SELECT #{id} AS ADM_ID, A.MEM_NM
					   , A.CELL
					   , A.HOME_ADDR
					   , A.HOME_ADDR2
					   , A.NOTE AS NOTE2
					   , B.ACCNT_NO
					   , B.JOIN_DT
					   , B.PROD_CD
					   , B.PROD_KIND
					   , B.PROD_MODEL_KIND
					   , B.INSPL_ZIP
					   , B.INSPL_ADDR
					   , B.INSPL_ADDR2
					   , B.INSPL_PHONE
					   , B.ORDER_NUM
					   , B.B2B_EMPLE_NO
					   , F.ORDER_DT
					   , F.CONFIRM_DT
					   , F.DELIVERY_DT
					   , F.HOLD_DT
					   , F.UPDATE_CELL
					   , F.UPDATE_ADDR
					   , E.COM_NM AS B2B_COMP_NM 
					   , F.UPDATE_TYPE
					   , F.NOTE
					   , F.HPCALL_YN
					   , F.ETC
				<choose>
					<when test="orderdateMng == 'Y'.toString()">
						, B.KB_NO
						, FN_MODEL_CL_NM(B.PROD_MODEL_KIND) AS PROD_MODEL
						, (SELECT X2.MODEL_NM 
						     FROM PRODUCT_MODEL_MST X1, PRODUCT_MODEL_DTL X2
							WHERE X1.SEQ = X2.SEQ 
							  AND X1.DEL_FG = 'N'
							  AND X1.PROD_CD = B.PROD_CD 
							  AND X1.PROD_KIND = B.PROD_MODEL_KIND 
							  AND X2.MODEL_CD = B.PROD_MODEL_CD) AS PROD_MODEL_NM
						, F.UPDATE_PADDR
						, F.NOSETUP_ETC
					</when>
					<otherwise>
						, B.KB_NO
						, FN_MODEL_CL_NM(B.PROD_MODEL_KIND) AS PROD_MODEL
						, (SELECT X2.MODEL_NM 
						     FROM PRODUCT_MODEL_MST X1, PRODUCT_MODEL_DTL X2
							WHERE X1.SEQ = X2.SEQ 
							  AND X1.DEL_FG = 'N'
							  AND X1.PROD_CD = B.PROD_CD 
							  AND X1.PROD_KIND = B.PROD_MODEL_KIND 
							  AND X2.MODEL_CD = B.PROD_MODEL_CD) AS PROD_MODEL_NM
						, F.UPDATE_PADDR
						, F.NOSETUP_ETC
					</otherwise>	
				</choose>
						
				  FROM MEMBER A, MEM_PROD_ACCNT B, PRODUCT C, B2BCOMCD E, DELIVERY_INFO F
				 WHERE A.MEM_NO = B.MEM_NO
				   AND B.PROD_CD = C.PROD_CD
				   AND B.B2B_COMP_CD = E.COM_CD(+)
				
				<choose>
					<when test="orderdateMng == 'Y'.toString()">
						AND B.ACCNT_NO = F.ACCNT_NO(+) 
					</when>
					<otherwise>
						AND B.ACCNT_NO = F.ACCNT_NO
					</otherwise>	
				</choose>
				   
				   AND A.DEL_FG = 'N'
				   AND B.DEL_FG = 'N'
				   AND EXISTS(SELECT 'X' FROM PAY_MNG WHERE DEL_FG = 'N' AND ACCNT_NO = B.ACCNT_NO)
				 
				<if test="id == 'lgorder'">
					AND (	(C.SECTION_THR IN ('0001','0006','0014') AND C.SECTION_T = '0002') 
						OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
						OR (C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG')) 
						OR (C.SECTION_THR = '0021' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG')) 
						OR (C.SECTION_THR = '0026' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG')) 
						OR (C.SECTION_THR = '0025' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG')) 
						OR (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG')) 
						OR (C.SECTION_THR = '0008' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
						OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG')) 
						OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))) 
				</if>		
				<if test="id == 'csvorder'">
					AND ((C.SECTION_THR IN ('0002','0015') AND C.SECTION_F != '0002') 
					OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
					OR (C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS')) 
					OR (C.SECTION_THR = '0021' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS')) 
					OR (C.SECTION_THR = '0026' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS')) 
					OR (C.SECTION_THR = '0025' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
					OR (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
					OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS')) 
					OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS')))
				</if>
				<if test="id == 'dhorder'">
					AND ((C.SECTION_THR = '0012' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH')) 
					OR (C.SECTION_THR = '0017' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH')) 
					OR (C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
					OR (C.SECTION_THR = '0021' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
					OR (C.SECTION_THR = '0026' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH')) 
					OR (C.SECTION_THR = '0025' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
					OR (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
					OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH')) 
					OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
					OR (C.SECTION_THR = '0031' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH')) 
         			OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))) 
				</if>
					<if test="id == 'isollat' or id == 'isorder'">
						AND (
						(C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER IN ( 'isollat', 'isorder' ) ))
						OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER IN ( 'isollat', 'isorder') ))
						)
					</if>
				
				<if test="id == 'sonoseason'">
					AND (
					(C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'sono'))
					OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'sono'))
					OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'sono'))
					) 
				</if>
				<if test="id == 'wmnetwork'">
					AND (
					(C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'wmnet'))
					OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'wmnet'))
					OR (C.SECTION_THR = '0021' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'wmnet'))
					OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'wmnet'))
					) 
				</if>

				<if test="id == 'mmorder'">
					AND (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LU'))
				</if>	

				<choose>
					<when test="orderdateMng == 'Y'.toString()">
						<if test="id == 'dyorder'">
							AND (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DY'))
						</if>					
					</when>
					<otherwise>
						<if test="id == 'dyorder'">
		                    AND (F.B2B_STAT = 'DONGYANG' 
		                         AND C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DY'))
						</if>					
					</otherwise>	
				</choose>
				
<!-- 
				<choose>
					<when test="orderdateMng == 'Y'.toString()">
						<if test="id == 'dyorder'">
							AND (C.PROD_GUBUN = '0028' 
							OR (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LV'))
		         			OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LV')))
						</if>					
					</when>
					<otherwise>
						<if test="id == 'dyorder'">
							AND F.B2B_STAT = 'DONGYANG'
						</if>					
					</otherwise>	
				</choose>
 -->
				<if test="daysel != null and daysel !=''">		
					<if test="strtDt != null and strtDt != '' and endDt != null and endDt != ''">
						<if test="daysel == 'orderDt'">						
							AND F.ORDER_DT <![CDATA[>=]]> REPLACE(#{strtDt}, '-', '')
							AND F.ORDER_DT <![CDATA[<=]]> REPLACE(#{endDt}, '-', '')
						</if>
						<if test="daysel == 'joinDt'">
							AND B.JOIN_DT <![CDATA[>=]]> REPLACE(#{strtDt}, '-', '')
							AND B.JOIN_DT <![CDATA[<=]]> REPLACE(#{endDt}, '-', '')
						</if>
						<if test="daysel == 'rescc'">
							AND EXISTS(SELECT 'X' FROM RESCISSION WHERE DEL_FG = 'N' AND ACCNT_NO = B.ACCNT_NO AND RESN_PROC_DAY <![CDATA[>=]]> REPLACE(#{strtDt}, '-', '') AND RESN_PROC_DAY <![CDATA[<=]]> REPLACE(#{endDt}, '-', ''))
						</if>
						<if test="daysel == 'orderChk'">
							AND REPLACE(F.UPDATE_ADDR, ' ', '') != REPLACE(B.INSPL_ZIP || ')' || B.INSPL_ADDR || B.INSPL_ADDR2, ' ', '')
							AND F.UPDATE_TYPE != (SELECT PROD_KIND_NM FROM PRODUCT_KIND WHERE SEQ = B.PROD_KIND AND MODEL_CL_CD = B.PROD_MODEL_KIND)
							AND F.UPDATE_CELL != A.CELL 
							AND F.ORDER_DT <![CDATA[>=]]> REPLACE(#{strtDt}, '-', '')
							AND F.ORDER_DT <![CDATA[<=]]> REPLACE(#{endDt}, '-', '')		
						</if>
						<if test="daysel == 'confirmDt'">
							AND F.CONFIRM_DT <![CDATA[>=]]> REPLACE(#{strtDt}, '-', '')
							AND F.CONFIRM_DT <![CDATA[<=]]> REPLACE(#{endDt}, '-', '')
						</if>
						<if test="daysel == 'deliveryDt'">
							AND F.DELIVERY_DT <![CDATA[>=]]> REPLACE(#{strtDt}, '-', '')
							AND F.DELIVERY_DT <![CDATA[<=]]> REPLACE(#{endDt}, '-', '')
						</if>
						<if test="daysel == 'holdDt'">
							AND F.HOLD_DT <![CDATA[>=]]> REPLACE(#{strtDt}, '-', '')
							AND F.HOLD_DT <![CDATA[<=]]> REPLACE(#{endDt}, '-', '')
						</if>
						<if test="daysel == 'allAccnt'">
							AND MEM_NM IN (
								SELECT MEM_NM 
								  FROM MEMBER A, MEM_PROD_ACCNT B, PRODUCT C, DELIVERY_INFO D
								 WHERE A.MEM_NO = B.MEM_NO
								   AND B.PROD_CD = C.PROD_CD
								   AND B.ACCNT_NO = D.ACCNT_NO
								   AND A.DEL_FG = 'N'
								   AND B.DEL_FG = 'N'
								<if test="id == 'lgorder'">
									AND (	(C.SECTION_THR IN ('0001','0006','0014') AND C.SECTION_T = '0002') 
										OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
										OR (C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG')) 
										OR (C.SECTION_THR = '0021' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG')) 
										OR (C.SECTION_THR = '0026' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG')) 
										OR (C.SECTION_THR = '0025' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG')) 
										OR (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG')) 
										OR (C.SECTION_THR = '0008' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
										OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG')) 
										OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))) 
								</if>		
								<if test="id == 'csvorder'">
									AND ((C.SECTION_THR IN ('0002','0015') AND C.SECTION_F != '0002') 
									OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
									OR (C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS')) 
									OR (C.SECTION_THR = '0021' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS')) 
									OR (C.SECTION_THR = '0026' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS')) 
									OR (C.SECTION_THR = '0025' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
									OR (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
									OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS')) 
									OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))) 
								</if>
								<if test="id == 'dhorder'">
									AND ((C.SECTION_THR = '0012' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH')) 
									OR (C.SECTION_THR = '0017' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH')) 
									OR (C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
									OR (C.SECTION_THR = '0021' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
									OR (C.SECTION_THR = '0026' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH')) 
									OR (C.SECTION_THR = '0025' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
									OR (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
									OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH')) 
									OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
									OR (C.SECTION_THR = '0031' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH')) 
				         			OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))) 
								</if>
							<if test="id == 'isollat' or id == 'isorder'">
								AND (
								(C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER IN ( 'isollat', 'isorder' ) ))
								OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER IN ( 'isollat', 'isorder') ))
								)
							</if>
								<if test="id == 'sonoseason'">
									AND (
									(C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'sono'))
									OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'sono'))
									OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'sono'))
									) 
								</if>
								<if test="id == 'wmnetwork'">
									AND (
									(C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'wmnet'))
									OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'wmnet'))
									OR (C.SECTION_THR = '0021' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'wmnet'))
									OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'wmnet'))
									) 
								</if>
								<if test="id == 'mmorder'">
									AND (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LU'))
								</if>	
								<if test="id == 'dyorder'">
									AND C.PROD_GUBUN IN ('0024', '0025', '0027')
								</if>
								   AND D.ORDER_DT <![CDATA[>=]]> REPLACE(#{strtDt}, '-', '')
								   AND D.ORDER_DT <![CDATA[<=]]> REPLACE(#{endDt}, '-', '')
								 GROUP BY A.MEM_NM, A.CELL 
								HAVING COUNT(A.MEM_NM) <![CDATA[>]]> 1
							)
						</if>
						<if test="daysel == 'noSetup'">
							AND TRUNC(TO_DATE(F.ORDER_DT, 'yyyyMMdd') - SYSDATE) <![CDATA[>=]]> 32 
							AND F.DELIVERY_DT IS NULL 
							AND FN_ACCNT_STAT(TBL.ACCNT_NO) NOT IN('Y', 'R', 'E')
						</if>
					</if>
				</if>
				<if test="q != null and q != ''">	
					<if test="f == 1">	
						AND A.MEM_NM LIKE '%' || #{q} || '%'
					</if>
					<if test="f == 2">	
						AND B.ACCNT_NO = #{q}
					</if>
					<if test="f == 3">	
						AND NVL(F.UPDATE_CELL, A.CELL) = #{q}
					</if>
					<if test="f == 4">	
						AND EXISTS(SELECT 'X' FROM PRODUCT WHERE PROD_CD = B.PROD_CD AND PROD_NM LIKE '%' || #{q} || '%')
					</if>
					<if test="f == 5">	
						AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND MODEL_CL_NM LIKE '%' || #{q} || '%')
					</if>
					<if test="f == 6">	
						AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_MST X1, PRODUCT_MODEL_DTL X2 
						 		    WHERE X1.SEQ = X2.SEQ 
						 		      AND X1.PROD_CD = B.PROD_CD 
						 		      AND X1.PROD_KIND = B.PROD_MODEL_KIND 
							 		  AND X2.MODEL_CD = B.PROD_MODEL_CD 
							 		  AND X1.DEL_FG = 'N' 
							 		  AND X2.MODEL_NM LIKE '%' || #{q} || '%')
					</if>				
					<if test="f == 7">	
						AND F.NOTE LIKE '%' || #{q} || '%'
					</if>
					<if test="f == 8">	
						AND E.COM_NM LIKE '%' || #{q} || '%'
					</if>
				</if>
				<if test="f == 9">	
					AND F.ORDER_DT IS NULL
				</if>
				<if test="f == 10">
					AND F.DELIVERY_DT IS NULL
				</if>
				<if test="f == 11">
					AND F.HOLD_DT IS NULL
				</if>
				<if test="f == 12">
					AND F.ORDER_DT IS NOT NULL
				</if>
				<if test="cancelViewYn == null">
					AND DECODE(FN_ACCNT_STAT(B.ACCNT_NO), 'Y', '정상', 'R', '해약', 'E', '행사', '청약철회')  != '청약철회'
				</if>
				</foreach>
				</when>
				<otherwise>
					SELECT #{id} AS ADM_ID, A.MEM_NM
					, A.CELL
					, A.HOME_ADDR
					, A.HOME_ADDR2
					, A.NOTE AS NOTE2
					, B.ACCNT_NO
					, B.JOIN_DT
					, B.PROD_CD
					, B.PROD_KIND
					, B.PROD_MODEL_KIND
					, B.INSPL_ZIP
					, B.INSPL_ADDR
					, B.INSPL_ADDR2
					, B.INSPL_PHONE
					, B.ORDER_NUM
					, B.B2B_EMPLE_NO
					, F.ORDER_DT
					, F.CONFIRM_DT
					, F.DELIVERY_DT
					, F.HOLD_DT
					, F.UPDATE_CELL
					, F.UPDATE_ADDR
					, E.COM_NM AS B2B_COMP_NM
					, F.UPDATE_TYPE
					, F.NOTE
					, F.HPCALL_YN
					, F.ETC
					<choose>
						<when test="orderdateMng == 'Y'.toString()">
							, B.KB_NO
							, FN_MODEL_CL_NM(B.PROD_MODEL_KIND) AS PROD_MODEL
							, (SELECT X2.MODEL_NM
							FROM PRODUCT_MODEL_MST X1, PRODUCT_MODEL_DTL X2
							WHERE X1.SEQ = X2.SEQ
							AND X1.DEL_FG = 'N'
							AND X1.PROD_CD = B.PROD_CD
							AND X1.PROD_KIND = B.PROD_MODEL_KIND
							AND X2.MODEL_CD = B.PROD_MODEL_CD) AS PROD_MODEL_NM
							, F.UPDATE_PADDR
							, F.NOSETUP_ETC
						</when>
						<otherwise>
							, B.KB_NO
							, FN_MODEL_CL_NM(B.PROD_MODEL_KIND) AS PROD_MODEL
							, (SELECT X2.MODEL_NM
							FROM PRODUCT_MODEL_MST X1, PRODUCT_MODEL_DTL X2
							WHERE X1.SEQ = X2.SEQ
							AND X1.DEL_FG = 'N'
							AND X1.PROD_CD = B.PROD_CD
							AND X1.PROD_KIND = B.PROD_MODEL_KIND
							AND X2.MODEL_CD = B.PROD_MODEL_CD) AS PROD_MODEL_NM
							, F.UPDATE_PADDR
							, F.NOSETUP_ETC
						</otherwise>
					</choose>

					FROM MEMBER A, MEM_PROD_ACCNT B, PRODUCT C, B2BCOMCD E, DELIVERY_INFO F
					WHERE A.MEM_NO = B.MEM_NO
					AND B.PROD_CD = C.PROD_CD
					AND B.B2B_COMP_CD = E.COM_CD(+)

					<choose>
						<when test="orderdateMng == 'Y'.toString()">
							AND B.ACCNT_NO = F.ACCNT_NO(+)
						</when>
						<otherwise>
							AND B.ACCNT_NO = F.ACCNT_NO
						</otherwise>
					</choose>

					AND A.DEL_FG = 'N'
					AND B.DEL_FG = 'N'
					AND EXISTS(SELECT 'X' FROM PAY_MNG WHERE DEL_FG = 'N' AND ACCNT_NO = B.ACCNT_NO)

					<if test="id == 'lgorder'">
						AND (	(C.SECTION_THR IN ('0001','0006','0014') AND C.SECTION_T = '0002')
						OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
						OR (C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
						OR (C.SECTION_THR = '0021' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
						OR (C.SECTION_THR = '0026' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
						OR (C.SECTION_THR = '0025' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
						OR (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
						OR (C.SECTION_THR = '0008' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
						OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
						OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG')))
					</if>
					<if test="id == 'csvorder'">
						AND ((C.SECTION_THR IN ('0002','0015') AND C.SECTION_F != '0002')
						OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
						OR (C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
						OR (C.SECTION_THR = '0021' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
						OR (C.SECTION_THR = '0026' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
						OR (C.SECTION_THR = '0025' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
						OR (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
						OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
						OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS')))
					</if>
					<if test="id == 'dhorder'">
						AND ((C.SECTION_THR = '0012' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
						OR (C.SECTION_THR = '0017' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
						OR (C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
						OR (C.SECTION_THR = '0021' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
						OR (C.SECTION_THR = '0026' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
						OR (C.SECTION_THR = '0025' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
						OR (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
						OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
						OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
						OR (C.SECTION_THR = '0031' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
						OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH')))
					</if>
					<if test="id == 'isollat' or id == 'isorder'">
						AND (
						(C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER IN ( 'isollat', 'isorder' ) ))
						OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER IN ( 'isollat', 'isorder') ))
						)
					</if>

					<if test="id == 'sonoseason'">
						AND (
						(C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'sono'))
						OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'sono'))
						OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'sono'))
						)
					</if>
					<if test="id == 'wmnetwork'">
						AND (
						(C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'wmnet'))
						OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'wmnet'))
						OR (C.SECTION_THR = '0021' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'wmnet'))
						OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'wmnet'))
						)
					</if>

					<if test="id == 'mmorder'">
						AND (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LU'))
					</if>

					<choose>
						<when test="orderdateMng == 'Y'.toString()">
							<if test="id == 'dyorder'">
								AND (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DY'))
							</if>
						</when>
						<otherwise>
							<if test="id == 'dyorder'">
								AND (F.B2B_STAT = 'DONGYANG'
								AND C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DY'))
							</if>
						</otherwise>
					</choose>

					<!--
                                    <choose>
                                        <when test="orderdateMng == 'Y'.toString()">
                                            <if test="id == 'dyorder'">
                                                AND (C.PROD_GUBUN = '0028'
                                                OR (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LV'))
                                                 OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LV')))
                                            </if>
                                        </when>
                                        <otherwise>
                                            <if test="id == 'dyorder'">
                                                AND F.B2B_STAT = 'DONGYANG'
                                            </if>
                                        </otherwise>
                                    </choose>
                     -->
					<if test="daysel != null and daysel !=''">
						<if test="strtDt != null and strtDt != '' and endDt != null and endDt != ''">
							<if test="daysel == 'orderDt'">
								AND F.ORDER_DT <![CDATA[>=]]> REPLACE(#{strtDt}, '-', '')
								AND F.ORDER_DT <![CDATA[<=]]> REPLACE(#{endDt}, '-', '')
							</if>
							<if test="daysel == 'joinDt'">
								AND B.JOIN_DT <![CDATA[>=]]> REPLACE(#{strtDt}, '-', '')
								AND B.JOIN_DT <![CDATA[<=]]> REPLACE(#{endDt}, '-', '')
							</if>
							<if test="daysel == 'rescc'">
								AND EXISTS(SELECT 'X' FROM RESCISSION WHERE DEL_FG = 'N' AND ACCNT_NO = B.ACCNT_NO AND RESN_PROC_DAY <![CDATA[>=]]> REPLACE(#{strtDt}, '-', '') AND RESN_PROC_DAY <![CDATA[<=]]> REPLACE(#{endDt}, '-', ''))
							</if>
							<if test="daysel == 'orderChk'">
								AND REPLACE(F.UPDATE_ADDR, ' ', '') != REPLACE(B.INSPL_ZIP || ')' || B.INSPL_ADDR || B.INSPL_ADDR2, ' ', '')
								AND F.UPDATE_TYPE != (SELECT PROD_KIND_NM FROM PRODUCT_KIND WHERE SEQ = B.PROD_KIND AND MODEL_CL_CD = B.PROD_MODEL_KIND)
								AND F.UPDATE_CELL != A.CELL
								AND F.ORDER_DT <![CDATA[>=]]> REPLACE(#{strtDt}, '-', '')
								AND F.ORDER_DT <![CDATA[<=]]> REPLACE(#{endDt}, '-', '')
							</if>
							<if test="daysel == 'confirmDt'">
								AND F.CONFIRM_DT <![CDATA[>=]]> REPLACE(#{strtDt}, '-', '')
								AND F.CONFIRM_DT <![CDATA[<=]]> REPLACE(#{endDt}, '-', '')
							</if>
							<if test="daysel == 'deliveryDt'">
								AND F.DELIVERY_DT <![CDATA[>=]]> REPLACE(#{strtDt}, '-', '')
								AND F.DELIVERY_DT <![CDATA[<=]]> REPLACE(#{endDt}, '-', '')
							</if>
							<if test="daysel == 'holdDt'">
								AND F.HOLD_DT <![CDATA[>=]]> REPLACE(#{strtDt}, '-', '')
								AND F.HOLD_DT <![CDATA[<=]]> REPLACE(#{endDt}, '-', '')
							</if>
							<if test="daysel == 'allAccnt'">
								AND MEM_NM IN (
								SELECT MEM_NM
								FROM MEMBER A, MEM_PROD_ACCNT B, PRODUCT C, DELIVERY_INFO D
								WHERE A.MEM_NO = B.MEM_NO
								AND B.PROD_CD = C.PROD_CD
								AND B.ACCNT_NO = D.ACCNT_NO
								AND A.DEL_FG = 'N'
								AND B.DEL_FG = 'N'
								<if test="id == 'lgorder'">
									AND (	(C.SECTION_THR IN ('0001','0006','0014') AND C.SECTION_T = '0002')
									OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
									OR (C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
									OR (C.SECTION_THR = '0021' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
									OR (C.SECTION_THR = '0026' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
									OR (C.SECTION_THR = '0025' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
									OR (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
									OR (C.SECTION_THR = '0008' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
									OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
									OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG')))
								</if>
								<if test="id == 'csvorder'">
									AND ((C.SECTION_THR IN ('0002','0015') AND C.SECTION_F != '0002')
									OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
									OR (C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
									OR (C.SECTION_THR = '0021' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
									OR (C.SECTION_THR = '0026' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
									OR (C.SECTION_THR = '0025' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
									OR (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
									OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
									OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS')))
								</if>
								<if test="id == 'dhorder'">
									AND ((C.SECTION_THR = '0012' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
									OR (C.SECTION_THR = '0017' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
									OR (C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
									OR (C.SECTION_THR = '0021' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
									OR (C.SECTION_THR = '0026' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
									OR (C.SECTION_THR = '0025' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
									OR (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
									OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
									OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
									OR (C.SECTION_THR = '0031' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
									OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH')))
								</if>
								<if test="id == 'isollat' or id == 'isorder'">
									AND (
									(C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER IN ( 'isollat', 'isorder' ) ))
									OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER IN ( 'isollat', 'isorder') ))
									)
								</if>
								<if test="id == 'sonoseason'">
									AND (
									(C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'sono'))
									OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'sono'))
									OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'sono'))
									)
								</if>
								<if test="id == 'wmnetwork'">
									AND (
									(C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'wmnet'))
									OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'wmnet'))
									OR (C.SECTION_THR = '0021' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'wmnet'))
									OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'wmnet'))
									)
								</if>
								<if test="id == 'mmorder'">
									AND (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LU'))
								</if>
								<if test="id == 'dyorder'">
									AND C.PROD_GUBUN IN ('0024', '0025', '0027')
								</if>
								AND D.ORDER_DT <![CDATA[>=]]> REPLACE(#{strtDt}, '-', '')
								AND D.ORDER_DT <![CDATA[<=]]> REPLACE(#{endDt}, '-', '')
								GROUP BY A.MEM_NM, A.CELL
								HAVING COUNT(A.MEM_NM) <![CDATA[>]]> 1
								)
							</if>
							<if test="daysel == 'noSetup'">
								AND TRUNC(TO_DATE(F.ORDER_DT, 'yyyyMMdd') - SYSDATE) <![CDATA[>=]]> 32
								AND F.DELIVERY_DT IS NULL
								AND FN_ACCNT_STAT(TBL.ACCNT_NO) NOT IN('Y', 'R', 'E')
							</if>
						</if>
					</if>
					<if test="q != null and q != ''">
						<if test="f == 1">
							AND A.MEM_NM LIKE '%' || #{q} || '%'
						</if>
						<if test="f == 2">
							AND B.ACCNT_NO = #{q}
						</if>
						<if test="f == 3">
							AND NVL(F.UPDATE_CELL, A.CELL) = #{q}
						</if>
						<if test="f == 4">
							AND EXISTS(SELECT 'X' FROM PRODUCT WHERE PROD_CD = B.PROD_CD AND PROD_NM LIKE '%' || #{q} || '%')
						</if>
						<if test="f == 5">
							AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND MODEL_CL_NM LIKE '%' || #{q} || '%')
						</if>
						<if test="f == 6">
							AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_MST X1, PRODUCT_MODEL_DTL X2
							WHERE X1.SEQ = X2.SEQ
							AND X1.PROD_CD = B.PROD_CD
							AND X1.PROD_KIND = B.PROD_MODEL_KIND
							AND X2.MODEL_CD = B.PROD_MODEL_CD
							AND X1.DEL_FG = 'N'
							AND X2.MODEL_NM LIKE '%' || #{q} || '%')
						</if>
						<if test="f == 7">
							AND F.NOTE LIKE '%' || #{q} || '%'
						</if>
						<if test="f == 8">
							AND E.COM_NM LIKE '%' || #{q} || '%'
						</if>
					</if>
					<if test="f == 9">
						AND F.ORDER_DT IS NULL
					</if>
					<if test="f == 10">
						AND F.DELIVERY_DT IS NULL
					</if>
					<if test="f == 11">
						AND F.HOLD_DT IS NULL
					</if>
					<if test="f == 12">
						AND F.ORDER_DT IS NOT NULL
					</if>
					<if test="cancelViewYn == null">
						AND DECODE(FN_ACCNT_STAT(B.ACCNT_NO), 'Y', '정상', 'R', '해약', 'E', '행사', '청약철회')  != '청약철회'
					</if>
				</otherwise>
				</choose>
				 ORDER BY JOIN_DT DESC, MEM_NM
			) T1
		) TBL
	</select>

	<!--
         쿼리명 : OMBOrderMngDAO.selectOrderMng
         설  명 : 외주업체 발주관리 상세를 조회한다.
       	  수정일     수정자      수정내용 
        ==========   ======   ============== 
        2016.02.16   김필기     최초 생성
		2018.07.20   한상민     mmoder 계정 전체 수정
    -->	
	<select id="OMBOrderMngDAO.selectOrderMng" parameterType="emfMap" resultType="emfMap">
		SELECT /* OMBOrderMngDAO.selectOrderMng */
			   B.ACCNT_NO
			   , A.MEM_NM
			   , FN_PROD_NM(B.PROD_CD) AS PROD_NM
			   , FN_MODEL_CL_NM(B.PROD_MODEL_KIND) AS PROD_MODEL
			   , NVL(D.UPDATE_TYPE, (SELECT PROD_KIND_NM FROM PRODUCT_KIND WHERE SEQ = B.PROD_KIND AND MODEL_CL_CD = B.PROD_MODEL_KIND)) AS PROD_KIND
			   , NVL(D.UPDATE_CELL, A.CELL) AS CELL
			   , B.INSPL_PHONE
			   , (A.HOME_ADDR || ' ' || A.HOME_ADDR2) AS HOME_ADDR
			   , NVL(D.UPDATE_ADDR, B.INSPL_ZIP || ')' || B.INSPL_ADDR || ' ' || B.INSPL_ADDR2) AS INSPL_ADDR
			   , D.ORDER_DT
			   , D.CONFIRM_DT
			   , D.DELIVERY_DT
			   , D.HOLD_DT
			   , D.HPCALL_YN
			   , D.ETC
			   , D.NOTE
			   , D.UPDATE_ADDR
			   , (A.WRPL_ADDR || ' ' || A.WRPL_ADDR2) AS WRPL_ADDR
			   , D.DELIVERY_LOG
		  FROM MEMBER A, MEM_PROD_ACCNT B, PRODUCT C, DELIVERY_INFO D
		 WHERE A.MEM_NO = B.MEM_NO
		   AND B.PROD_CD = C.PROD_CD
		   AND B.ACCNT_NO = D.ACCNT_NO
		   AND A.DEL_FG = 'N'
		   AND B.DEL_FG = 'N'
		   AND B.ACCNT_NO = #{accntNo}
	</select>

	<!--
         쿼리명 : OMBOrderMngDAO.updateDelv
         설  명 : 외주업체 발주관리 납품일을 수정한다.
       	  수정일     수정자      수정내용 
        ==========   ======   ============== 
        2016.03.21   김필기     최초 생성
		2018.07.20   한상민     mmoder 계정 전체 수정
    -->		
	<update id="OMBOrderMngDAO.updateDelv" parameterType="emfMap">
		UPDATE /* OMBOrderMngDAO.updateDelv */ DELIVERY_INFO T1
		   SET DELIVERY_DT = TO_CHAR(TO_DATE(#{delvdate}, 'yyyy-MM-dd hh24:mi:ss'), 'yyyyMMdd')
			   , UPD_DM = SYSDATE
			   , UPD_MAN = #{id, jdbcType=VARCHAR}
			   , DELIVERY_LOG = (SELECT MAX(DELIVERY_LOG) KEEP(DENSE_RANK FIRST ORDER BY B.ACCNT_NO) 
			                        FROM MEMBER A, MEM_PROD_ACCNT B, PRODUCT C, DELIVERY_INFO D
								   WHERE A.MEM_NO = B.MEM_NO
								     AND B.PROD_CD = C.PROD_CD
									 AND B.ACCNT_NO = D.ACCNT_NO(+)
									 AND A.DEL_FG = 'N'
								     AND B.DEL_FG = 'N'
								     AND B.JOIN_DT <![CDATA[>=]]> REPLACE(#{strtDt}, '-', '')
									 AND B.JOIN_DT <![CDATA[<=]]> REPLACE(#{endDt}, '-', '')
									 AND EXISTS(SELECT 'X' FROM PAY_MNG WHERE DEL_FG = 'N' AND ACCNT_NO = B.ACCNT_NO)
									 AND FN_ACCNT_STAT(B.ACCNT_NO) = 'Y'
									 AND D.ORDER_DT IS NOT NULL
									 AND B.ACCNT_NO = T1.ACCNT_NO
								) 
								|| ' / 납품일자 ' || TO_CHAR(SYSDATE, 'yyyy-MM-dd') || ' -> '
								|| (SELECT TO_CHAR(NVL(TO_DATE(MAX(DELIVERY_DT), 'yyyy-MM-dd'), SYSDATE), 'yyyy-MM-dd')
									 FROM MEMBER A, MEM_PROD_ACCNT B, PRODUCT C, DELIVERY_INFO D
								    WHERE A.MEM_NO = B.MEM_NO
								      AND B.PROD_CD = C.PROD_CD
								      AND B.ACCNT_NO = D.ACCNT_NO(+)
									  AND A.DEL_FG = 'N'
									  AND B.DEL_FG = 'N'
									  AND C.PROD_GUBUN IN ('0010', '0011', '0017', '0018', '0019')
									  AND B.JOIN_DT <![CDATA[>=]]> REPLACE(#{strtDt}, '-', '')
									  AND B.JOIN_DT <![CDATA[<=]]> REPLACE(#{endDt}, '-', '')
									  AND EXISTS(SELECT 'X' FROM PAY_MNG WHERE DEL_FG = 'N' AND ACCNT_NO = B.ACCNT_NO)
									  AND FN_ACCNT_STAT(B.ACCNT_NO) = 'Y'
									  AND D.ORDER_DT IS NOT NULL
									  AND B.ACCNT_NO = T1.ACCNT_NO
								) 
		 WHERE ACCNT_NO IN
		<foreach collection="accntNo" item="item" index="index" separator=", " open="(" close=")">
			#{item}
		</foreach>			
	</update>
	
	<!--
         쿼리명 : OMBOrderMngDAO.updateHold
         설  명 : 외주업체 발주관리 납품일을 수정한다.
       	  수정일     수정자      수정내용 
        ==========   ======   ============== 
        2016.03.21   김필기     최초 생성
    -->		
	<update id="OMBOrderMngDAO.updateHold" parameterType="emfMap">
		UPDATE /* OMBOrderMngDAO.updateHold */ DELIVERY_INFO T1
		   SET HOLD_DT = TO_CHAR(TO_DATE(#{holddate}, 'yyyy-MM-dd hh24:mi:ss'), 'yyyyMMdd')
			   , UPD_DM = SYSDATE
			   , UPD_MAN = #{id, jdbcType=VARCHAR}
			   , DELIVERY_LOG = (SELECT MAX(DELIVERY_LOG) KEEP(DENSE_RANK FIRST ORDER BY B.ACCNT_NO) 
			                        FROM MEMBER A, MEM_PROD_ACCNT B, PRODUCT C, DELIVERY_INFO D
								   WHERE A.MEM_NO = B.MEM_NO
								     AND B.PROD_CD = C.PROD_CD
									 AND B.ACCNT_NO = D.ACCNT_NO(+)
									 AND A.DEL_FG = 'N'
								     AND B.DEL_FG = 'N'
								     AND B.JOIN_DT <![CDATA[>=]]> REPLACE(#{strtDt}, '-', '')
									 AND B.JOIN_DT <![CDATA[<=]]> REPLACE(#{endDt}, '-', '')
									 AND EXISTS(SELECT 'X' FROM PAY_MNG WHERE DEL_FG = 'N' AND ACCNT_NO = B.ACCNT_NO)
									 AND FN_ACCNT_STAT(B.ACCNT_NO) = 'Y'
									 AND D.ORDER_DT IS NOT NULL
									 AND B.ACCNT_NO = T1.ACCNT_NO
								) 
								|| ' / 보류일자 ' || TO_CHAR(SYSDATE, 'yyyy-MM-dd') || ' -> '
								|| (SELECT TO_CHAR(NVL(TO_DATE(MAX(HOLD_DT), 'yyyy-MM-dd'), SYSDATE), 'yyyy-MM-dd')
									 FROM MEMBER A, MEM_PROD_ACCNT B, PRODUCT C, DELIVERY_INFO D
								    WHERE A.MEM_NO = B.MEM_NO
								      AND B.PROD_CD = C.PROD_CD
								      AND B.ACCNT_NO = D.ACCNT_NO(+)
									  AND A.DEL_FG = 'N'
									  AND B.DEL_FG = 'N'
									  AND C.PROD_GUBUN IN ('0010', '0011', '0017', '0018', '0019')
									  AND B.JOIN_DT <![CDATA[>=]]> REPLACE(#{strtDt}, '-', '')
									  AND B.JOIN_DT <![CDATA[<=]]> REPLACE(#{endDt}, '-', '')
									  AND EXISTS(SELECT 'X' FROM PAY_MNG WHERE DEL_FG = 'N' AND ACCNT_NO = B.ACCNT_NO)
									  AND FN_ACCNT_STAT(B.ACCNT_NO) = 'Y'
									  AND D.ORDER_DT IS NOT NULL
									  AND B.ACCNT_NO = T1.ACCNT_NO
								) 
		 WHERE ACCNT_NO IN
		<foreach collection="accntNo" item="item" index="index" separator=", " open="(" close=")">
			#{item}
		</foreach>			
	</update>

	<!--
         쿼리명 : OMBOrderMngDAO.updateReq
         설  명 : 외주업체 발주관리 배송상황일을 수정한다.
       	  수정일     수정자      수정내용 
        ==========   ======   ============== 
        2016.03.21   김필기     최초 생성
		2018.07.20   한상민     mmoder 계정 전체 수정
    -->		
	<update id="OMBOrderMngDAO.updateReq" parameterType="emfMap">
		UPDATE /* OMBOrderMngDAO.updateReq */ DELIVERY_INFO T1
		   SET CONFIRM_DT = TO_CHAR(TO_DATE(#{reqdate}, 'yyyy-MM-dd hh24:mi:ss'), 'yyyyMMdd')
			   , UPD_DM = SYSDATE
			   , UPD_MAN = #{id, jdbcType=VARCHAR}
			   , DELIVERY_LOG = (SELECT MAX(DELIVERY_LOG) KEEP(DENSE_RANK FIRST ORDER BY B.ACCNT_NO)
			     			       FROM MEMBER A, MEM_PROD_ACCNT B, PRODUCT C, DELIVERY_INFO D
								  WHERE A.MEM_NO = B.MEM_NO
								    AND B.PROD_CD = C.PROD_CD
								    AND B.ACCNT_NO = D.ACCNT_NO(+)
									AND A.DEL_FG = 'N'
									AND B.DEL_FG = 'N'
								    AND B.JOIN_DT <![CDATA[>=]]> REPLACE(#{strtDt}, '-', '')
									AND B.JOIN_DT <![CDATA[<=]]> REPLACE(#{endDt}, '-', '')
									AND EXISTS(SELECT 'X' FROM PAY_MNG WHERE DEL_FG = 'N' AND ACCNT_NO = B.ACCNT_NO)
									AND FN_ACCNT_STAT(B.ACCNT_NO) = 'Y'
									AND D.ORDER_DT IS NOT NULL
									AND B.ACCNT_NO = T1.ACCNT_NO
								) 
								|| ' / 배송상황 ' || TO_CHAR(SYSDATE, 'yyyy-MM-dd') || ' -> '
								|| (SELECT TO_CHAR(NVL(TO_DATE(MAX(CONFIRM_DT), 'yyyy-MM-dd'), SYSDATE), 'yyyy-MM-dd')
									 FROM MEMBER A, MEM_PROD_ACCNT B, PRODUCT C, DELIVERY_INFO D
								    WHERE A.MEM_NO = B.MEM_NO
								      AND B.PROD_CD = C.PROD_CD
								      AND B.ACCNT_NO = D.ACCNT_NO(+)
									  AND A.DEL_FG = 'N'
									  AND B.DEL_FG = 'N'
									  AND C.PROD_GUBUN IN ('0010', '0011', '0017', '0018', '0019')
									  AND B.JOIN_DT <![CDATA[>=]]> REPLACE(#{strtDt}, '-', '')
									  AND B.JOIN_DT <![CDATA[<=]]> REPLACE(#{endDt}, '-', '')
									  AND EXISTS(SELECT 'X' FROM PAY_MNG WHERE DEL_FG = 'N' AND ACCNT_NO = B.ACCNT_NO)
									  AND FN_ACCNT_STAT(B.ACCNT_NO) = 'Y'
									  AND D.ORDER_DT IS NOT NULL
									  AND B.ACCNT_NO = T1.ACCNT_NO
								) 
		 WHERE ACCNT_NO IN
		<foreach collection="accntNo" item="item" index="index" separator=", " open="(" close=")">
			#{item}
        </foreach>			
	</update>	
	
	<!--
         쿼리명 : OMBOrderMngDAO.updateRowudt
         설  명 : 외주업체 발주관리 정보를 업데이트한다.
       	  수정일     수정자      수정내용 
        ==========   ======   ============== 
        2016.03.21   김필기     최초 생성
		2018.07.20   한상민     mmoder 계정 전체 수정
    -->		
	<update id="OMBOrderMngDAO.updateRowudt" parameterType="emfMap">
		UPDATE /* OMBOrderMngDAO.updateRowudt */ DELIVERY_INFO
		   SET DELIVERY_DT = TO_CHAR(TO_DATE(#{delvdate}, 'yyyy-MM-dd hh24:mi:ss'), 'yyyyMMdd')
			   , HOLD_DT = TO_CHAR(TO_DATE(#{holddate}, 'yyyy-MM-dd hh24:mi:ss'), 'yyyyMMdd')
			   , CONFIRM_DT = TO_CHAR(TO_DATE(#{reqdate}, 'yyyy-MM-dd hh24:mi:ss'), 'yyyyMMdd')
			   , HPCALL_YN = #{hpcallYn, jdbcType=VARCHAR}
			   , UPDATE_TYPE = #{updateType, jdbcType=VARCHAR}
			   <if test="updateCell != null and updateCell != ''">
			   , UPDATE_CELL = #{updateCell, jdbcType=VARCHAR}
			   </if>
			   , NOSETUP_ETC = #{nosetupEtc, jdbcType=VARCHAR}
			   , UPD_DM = SYSDATE
			   , UPD_MAN = #{id, jdbcType=VARCHAR}
		 WHERE ACCNT_NO = #{accntNo}			
	</update>
	
	<!--
         쿼리명 : OMBOrderMngDAO.insertDeliveryInfo
         설  명 : 외주업체 발주등록
       	  수정일     수정자      수정내용 
        ==========   ======   ============== 
        2016.04.15   김필기     최초 생성
		2018.07.20   한상민     mmoder 계정 전체 수정
    -->		
	<insert id="OMBOrderMngDAO.insertDeliveryInfo" parameterType="emfMap">
		INSERT /* OMBOrderMngDAO.insertDeliveryInfo */ INTO DELIVERY_INFO
			(ORDER_DT
			, ACCNT_NO
			, UPDATE_TYPE
			, UPDATE_CELL
			, UPDATE_ADDR
			, REG_DM
			, DELIVERY_LOG
			, B2B_STAT
			, REG_MAN
			)
		SELECT TO_CHAR(TO_DATE(#{orderdate}, 'yyyy-MM-dd hh24:mi:ss'), 'yyyyMMdd')
			   , B.ACCNT_NO
			   , (SELECT PROD_KIND_NM FROM PRODUCT_KIND WHERE SEQ = B.PROD_KIND AND MODEL_CL_CD = B.PROD_MODEL_KIND)
			   , A.CELL
			   , B.INSPL_ZIP || ')' || B.INSPL_ADDR || ' ' || B.INSPL_ADDR2
			   , SYSDATE
			   , TO_CHAR(SYSDATE, 'yyyy-MM-dd') || '-> 발주등록.'
			   , #{b2bStat}
			   , #{id}
		  FROM MEMBER A, MEM_PROD_ACCNT B, PRODUCT C, DELIVERY_INFO D
		 WHERE A.MEM_NO = B.MEM_NO
		   AND B.PROD_CD = C.PROD_CD
		   AND B.ACCNT_NO = D.ACCNT_NO(+)
		   AND A.DEL_FG = 'N'
		   AND B.DEL_FG = 'N'
		<if test="id == 'lgorder'">
			AND (	(C.SECTION_THR IN ('0001','0006','0014') AND C.SECTION_T = '0002') 
				OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
				OR (C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG')) 
				OR (C.SECTION_THR = '0021' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG')) 
				OR (C.SECTION_THR = '0026' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG')) 
				OR (C.SECTION_THR = '0025' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG')) 
				OR (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG')) 
				OR (C.SECTION_THR = '0008' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))
				OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG')) 
				OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LG'))) 
		</if>		
		<if test="id == 'csvorder'">
			AND ((C.SECTION_THR IN ('0002','0015') AND C.SECTION_F != '0002') 
			OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
			OR (C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS')) 
			OR (C.SECTION_THR = '0021' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS')) 
			OR (C.SECTION_THR = '0026' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS')) 
			OR (C.SECTION_THR = '0025' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
			OR (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))
			OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS')) 
			OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'SS'))) 
		</if>
		<if test="id == 'dhorder'">
			AND ((C.SECTION_THR = '0012' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH')) 
			OR (C.SECTION_THR = '0017' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH')) 
			OR (C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
			OR (C.SECTION_THR = '0021' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
			OR (C.SECTION_THR = '0026' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH')) 
			OR (C.SECTION_THR = '0025' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
			OR (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
			OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH')) 
			OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))
			OR (C.SECTION_THR = '0031' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH')) 
       		OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DH'))) 
		</if>
		<if test="id == 'isollat' or id == 'isorder'">
			AND (
			(C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER IN ( 'isollat', 'isorder' ) ))
			OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER IN ( 'isollat', 'isorder') ))
			)
		</if>
		<if test="id == 'sonoseason'">
			AND (
			(C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'sono'))
			OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'sono'))
			OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'sono'))
			) 
		</if>
		<if test="id == 'wmnetwork'">
			AND (
			(C.SECTION_THR = '0020' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'wmnet'))
			OR (C.SECTION_THR = '0028' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'wmnet'))
			OR (C.SECTION_THR = '0021' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'wmnet'))
			OR (C.SECTION_THR = '0029' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'wmnet'))
			) 
		</if>
		<if test="id == 'mmorder'">
			AND (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LU'))
		</if>

		<if test="id == 'dyorder'">
			AND (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'DY'))
		</if>					
<!-- 
		<if test="id == 'dyorder'">
			AND (C.PROD_GUBUN = '0028'
			OR (C.SECTION_THR = '0027' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LV'))
         	OR (C.SECTION_THR = '0032' AND EXISTS(SELECT 'X' FROM PRODUCT_MODEL_CL_CD WHERE MODEL_CL_CD = B.PROD_MODEL_KIND AND SALE_VENDER = 'LV')))
		</if>
 -->
		   AND B.JOIN_DT <![CDATA[>=]]> REPLACE(#{strtDt}, '-', '')
		   AND B.JOIN_DT <![CDATA[<=]]> REPLACE(#{endDt}, '-', '')
		   AND EXISTS(SELECT 'X' FROM PAY_MNG WHERE DEL_FG = 'N' AND ACCNT_NO = B.ACCNT_NO)
		   AND D.ORDER_DT IS NULL
		   AND B.ACCNT_NO IN
		<foreach collection="accntNo" item="item" index="index" separator=", " open="(" close=")">
			#{item}
        </foreach>			
	</insert>					
	
	<!--
         쿼리명 : OMBOrderMngDAO.updateReply
         설  명 : 외주업체 발주관리 상세정보를 변경한다.
       	  수정일     수정자      수정내용 
        ==========   ======   ============== 
        2016.03.21   김필기     최초 생성
		2018.07.20   한상민     mmoder 계정 전체 수정
    -->		
	<update id="OMBOrderMngDAO.updateReply" parameterType="emfMap">
		UPDATE /* OMBOrderMngDAO.updateReply */ DELIVERY_INFO
		   SET DELIVERY_DT = TO_CHAR(TO_DATE(#{delvdate}, 'yyyy-MM-dd hh24:mi:ss'), 'yyyyMMdd')
			   , HOLD_DT = TO_CHAR(TO_DATE(#{holddate}, 'yyyy-MM-dd hh24:mi:ss'), 'yyyyMMdd')
			   , CONFIRM_DT = TO_CHAR(TO_DATE(#{reqdate}, 'yyyy-MM-dd hh24:mi:ss'), 'yyyyMMdd')
			   , NOTE = #{content, jdbcType=VARCHAR}
			   , ETC = #{csetc, jdbcType=VARCHAR}
			   , HPCALL_YN = #{opthpcall, jdbcType=VARCHAR}
			   , UPDATE_TYPE = #{prodkind, jdbcType=VARCHAR}
			   , UPDATE_CELL = #{cell, jdbcType=VARCHAR}
			   , UPDATE_ADDR = #{inspaddr, jdbcType=VARCHAR}
			<if test="updateAddr != null and updateAddr != ''">
				, UPDATE_PADDR = #{updateAddr, jdbcType=VARCHAR}
			</if>				
			   , DELIVERY_LOG = #{log} || ' / ' ||  TO_CHAR(SYSDATE, 'yyyy-MM-dd') || '-> 배송상황 변경전(' || #{confdt} || ') -> 납품일 변경전(' || #{delvdt} || ')  -> 특이사항 변경전(' || #{etc} || ')'
			   , UPD_DM = SYSDATE
			   , UPD_MAN = #{id, jdbcType=VARCHAR}
		 WHERE ACCNT_NO = #{accntNo}			
	</update>	
	
</mapper>